// https://github.com/topojson/topojson-client Version 1.8.0. Copyright 2016 Mike Bostock.

// https://d3js.org/d3-array/ Version 1.0.2. Copyright 2016 Mike Bostock.

// https://d3js.org/d3-geo/ Version 1.4.0. Copyright 2016 Mike Bostock.

// https://d3js.org/d3-geo-projection/ Version 1.2.1. Copyright 2016 Mike Bostock.

var host=window.location.host,protocol=window.location.protocol,api_root=protocol+"//"+host+"/api/1.0";define("rest_urls",{taxon_list:api_root+"/data/taxon/",plot_list:api_root+"/data/plot/",plot_dashboard:api_root+"/dashboard/plot_dashboard/"}),define("taxonomy",["rest_urls"],function(n){function t(n,t){t=t||{};for(var r=t.id_attr||"id",e=t.make_node||null,o=t.parent_attr||"parent",i=t.nodes_attr||"nodes",u=t.make_leaf||null,a={},c=[],l=0;l<n.length;l++){var f=n[l];f[i]=[],null!=e&&e(f),a[f[r]]=f}for(var s in a){var g=a[s];null!=g[o]&&a[g[o]][i].push(g)}for(var l=0;l<n.length;l++){var g=a[n[l][r]];0==g[i].length&&(g[i]=null,null!=u&&u(g)),null==g[o]&&c.push(g)}return c}function r(r,e){$.ajax({type:"GET",url:n.taxon_list,success:function(n){e=e||null;var o=n,i=t(o,e);r(i)}})}return{getTaxaTree:r}}),!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define("topojson",["exports"],t):t(n.topojson=n.topojson||{})}(this,function(n){"use strict";function t(n){if(!n)return g;var t,r,e=n.scale[0],o=n.scale[1],i=n.translate[0],u=n.translate[1];return function(n,a){a||(t=r=0),n[0]=(t+=n[0])*e+i,n[1]=(r+=n[1])*o+u}}function r(n){if(!n)return g;var t,r,e=n.scale[0],o=n.scale[1],i=n.translate[0],u=n.translate[1];return function(n,a){a||(t=r=0);var c=Math.round((n[0]-i)/e),l=Math.round((n[1]-u)/o);n[0]=c-t,n[1]=l-r,t=c,r=l}}function e(n,t){for(var r,e=n.length,o=e-t;o<--e;)r=n[o],n[o++]=n[e],n[e]=r}function o(n,t){for(var r=0,e=n.length;r<e;){var o=r+e>>>1;n[o]<t?r=o+1:e=o}return r}function i(n,t){var r={type:"Feature",id:t.id,properties:t.properties||{},geometry:u(n,t)};return null==t.id&&delete r.id,r}function u(n,r){function o(n,t){t.length&&t.pop();for(var r,o=s[n<0?~n:n],i=0,u=o.length;i<u;++i)t.push(r=o[i].slice()),f(r,i);n<0&&e(t,u)}function i(n){return n=n.slice(),f(n,0),n}function u(n){for(var t=[],r=0,e=n.length;r<e;++r)o(n[r],t);return t.length<2&&t.push(t[0].slice()),t}function a(n){for(var t=u(n);t.length<4;)t.push(t[0].slice());return t}function c(n){return n.map(a)}function l(n){var t=n.type;return"GeometryCollection"===t?{type:t,geometries:n.geometries.map(l)}:t in g?{type:t,coordinates:g[t](n)}:null}var f=t(n.transform),s=n.arcs,g={Point:function(n){return i(n.coordinates)},MultiPoint:function(n){return n.coordinates.map(i)},LineString:function(n){return u(n.arcs)},MultiLineString:function(n){return n.arcs.map(u)},Polygon:function(n){return c(n.arcs)},MultiPolygon:function(n){return n.arcs.map(c)}};return l(r)}function a(n,t,r){function e(n){var t=n<0?~n:n;(l[t]||(l[t]=[])).push({i:n,g:c})}function o(n){n.forEach(e)}function i(n){n.forEach(o)}function u(n){"GeometryCollection"===n.type?n.geometries.forEach(u):n.type in f&&(c=n,f[n.type](n.arcs))}var a=[];if(arguments.length>1){var c,l=[],f={LineString:o,MultiLineString:i,Polygon:i,MultiPolygon:function(n){n.forEach(i)}};u(t),l.forEach(arguments.length<3?function(n){a.push(n[0].i)}:function(n){r(n[0].g,n[n.length-1].g)&&a.push(n[0].i)})}else for(var s=0,g=n.arcs.length;s<g;++s)a.push(s);return{type:"MultiLineString",arcs:p(n,a)}}function c(n){var t=n[0],r=n[1],e=n[2];return Math.abs((t[0]-e[0])*(r[1]-t[1])-(t[0]-r[0])*(e[1]-t[1]))}function l(n){for(var t,r=-1,e=n.length,o=n[e-1],i=0;++r<e;)t=o,o=n[r],i+=t[0]*o[1]-t[1]*o[0];return i/2}function f(n,t){function r(n){n.forEach(function(t){t.forEach(function(t){(o[t=t<0?~t:t]||(o[t]=[])).push(n)})}),i.push(n)}function e(t){return Math.abs(l(u(n,{type:"Polygon",arcs:[t]}).coordinates[0]))}var o={},i=[],a=[];return t.forEach(function(n){"Polygon"===n.type?r(n.arcs):"MultiPolygon"===n.type&&n.arcs.forEach(r)}),i.forEach(function(n){if(!n._){var t=[],r=[n];for(n._=1,a.push(t);n=r.pop();)t.push(n),n.forEach(function(n){n.forEach(function(n){o[n<0?~n:n].forEach(function(n){n._||(n._=1,r.push(n))})})})}}),i.forEach(function(n){delete n._}),{type:"MultiPolygon",arcs:a.map(function(t){var r,i=[];if(t.forEach(function(n){n.forEach(function(n){n.forEach(function(n){o[n<0?~n:n].length<2&&i.push(n)})})}),i=p(n,i),(r=i.length)>1)for(var u,a,c=1,l=e(i[0]);c<r;++c)(u=e(i[c]))>l&&(a=i[0],i[0]=i[c],i[c]=a,l=u);return i})}}function s(n,t){return n[1][2]-t[1][2]}var g=function(){},v=function(n,t){return"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map(function(t){return i(n,t)})}:i(n,t)},p=function(n,t){function r(t){var r,e=n.arcs[t<0?~t:t],o=e[0];return n.transform?(r=[0,0],e.forEach(function(n){r[0]+=n[0],r[1]+=n[1]})):r=e[e.length-1],t<0?[r,o]:[o,r]}function e(n,t){for(var r in n){var e=n[r];delete t[e.start],delete e.start,delete e.end,e.forEach(function(n){o[n<0?~n:n]=1}),a.push(e)}}var o={},i={},u={},a=[],c=-1;return t.forEach(function(r,e){var o,i=n.arcs[r<0?~r:r];i.length<3&&!i[1][0]&&!i[1][1]&&(o=t[++c],t[c]=r,t[e]=o)}),t.forEach(function(n){var t,e,o=r(n),a=o[0],c=o[1];if(t=u[a])if(delete u[t.end],t.push(n),t.end=c,e=i[c]){delete i[e.start];var l=e===t?t:t.concat(e);i[l.start=t.start]=u[l.end=e.end]=l}else i[t.start]=u[t.end]=t;else if(t=i[c])if(delete i[t.start],t.unshift(n),t.start=a,e=u[a]){delete u[e.end];var f=e===t?t:e.concat(t);i[f.start=e.start]=u[f.end=t.end]=f}else i[t.start]=u[t.end]=t;else t=[n],i[t.start=a]=u[t.end=c]=t}),e(u,i),e(i,u),t.forEach(function(n){o[n<0?~n:n]||a.push([n])}),a},h=function(n){return u(n,a.apply(this,arguments))},d=function(n){return u(n,f.apply(this,arguments))},y=function(n){function t(n,t){n.forEach(function(n){n<0&&(n=~n);var r=i[n];r?r.push(t):i[n]=[t]})}function r(n,r){n.forEach(function(n){t(n,r)})}function e(n,t){"GeometryCollection"===n.type?n.geometries.forEach(function(n){e(n,t)}):n.type in a&&a[n.type](n.arcs,t)}var i={},u=n.map(function(){return[]}),a={LineString:t,MultiLineString:r,Polygon:r,MultiPolygon:function(n,t){n.forEach(function(n){r(n,t)})}};n.forEach(e);for(var c in i)for(var l=i[c],f=l.length,s=0;s<f;++s)for(var g=s+1;g<f;++g){var v,p=l[s],h=l[g];(v=u[p])[c=o(v,h)]!==h&&v.splice(c,0,h),(v=u[h])[c=o(v,p)]!==p&&v.splice(c,0,p)}return u},m=function(){function n(n,t){for(;t>0;){var r=(t+1>>1)-1,o=e[r];if(s(n,o)>=0)break;e[o._=t]=o,e[n._=t=r]=n}}function t(n,t){for(;;){var r=t+1<<1,i=r-1,u=t,a=e[u];if(i<o&&s(e[i],a)<0&&(a=e[u=i]),r<o&&s(e[r],a)<0&&(a=e[u=r]),u===t)break;e[a._=t]=a,e[n._=t=u]=n}}var r={},e=[],o=0;return r.push=function(t){return n(e[t._=o]=t,o++),o},r.pop=function(){if(!(o<=0)){var n,r=e[0];return--o>0&&(n=e[o],t(e[n._=0]=n,0)),r}},r.remove=function(r){var i,u=r._;if(e[u]===r)return u!==--o&&(i=e[o],(s(i,r)<0?n:t)(e[i._=u]=i,u)),u},r},w=function(n,e){function o(n){a.remove(n),n[1][2]=e(n),a.push(n)}var i=t(n.transform),u=r(n.transform),a=m();return null==e&&(e=c),n.arcs.forEach(function(n){var t,r,c,l,f=[],s=0;for(r=0,c=n.length;r<c;++r)l=n[r],i(n[r]=[l[0],l[1],1/0],r);for(r=1,c=n.length-1;r<c;++r)t=n.slice(r-1,r+2),t[1][2]=e(t),f.push(t),a.push(t);for(r=0,c=f.length;r<c;++r)t=f[r],t.previous=f[r-1],t.next=f[r+1];for(;t=a.pop();){var g=t.previous,v=t.next;t[1][2]<s?t[1][2]=s:s=t[1][2],g&&(g.next=v,g[2]=t[2],o(g)),v&&(v.previous=g,v[0]=t[0],o(v))}n.forEach(u)}),n};n.mesh=h,n.meshArcs=a,n.merge=d,n.mergeArcs=f,n.feature=v,n.neighbors=y,n.presimplify=w,Object.defineProperty(n,"__esModule",{value:!0})});var host=window.location.host,protocol=window.location.protocol,static_root=protocol+"//"+host+"/static";define("static_urls",{nc_adm_topojson:static_root+"/topojson/nc_adm0.topojson"}),define("d3_distribution_donut",["jquery","d3"],function(n,t){function r(){function r(){var r=i,u=l.select(".slices").selectAll("path.slice").data(f(r));u.enter().insert("path").style("fill",function(n,t){return e[t]}).style("opacity","0.8").attr("class","slice").on("mouseover",function(n){t.select(this).style("opacity","1.0");var r="<p><strong>"+n.data[0]+"</strong></p>";r+="<p>"+parseFloat(100*(n.data[1]/o)).toFixed(2)+"%</p>",g.transition().duration(300).style("opacity",.9),g.html(r)}).on("mouseout",function(n){t.select(this).style("opacity","0.8"),g.transition().duration(300).style("opacity",0)}).on("mousemove",function(r){var e=n("#tooltip").width(),o=n("#tooltip").height();g.style("left",t.event.pageX-e/2-15+"px").style("top",t.event.pageY-o-25+"px")}).transition().duration(1e3).attrTween("d",function(n){this._current={endAngle:2*Math.PI,index:0,padAngle:0,startAngle:2*Math.PI,value:null};var r=t.interpolate(this._current,n);return this._current=r(0),function(n){return s(r(n))}}),u.transition().duration(1e3).attrTween("d",function(n){this._current=this._current||n;var r=t.interpolate(this._current,n);return this._current=r(0),function(n){return s(r(n))}}),u.exit().transition().duration(1e3).attrTween("d",function(n){this._current=this._current||n;var r={endAngle:this._current.endAngle,index:0,padAngle:0,startAngle:this._current.endAngle,value:null},e=t.interpolate(this._current,r);return this._current=e(0),function(n){return s(e(n))}}).remove()}var u=n("#taxon_proportions_widget").height(),a=n("#taxon_proportions_widget").width(),c=Math.min(a,u)/2,l=t.select("#taxon_proportions_widget").append("svg").attr("width",a).attr("height",u).append("g");l.append("g").attr("class","slices"),l.append("g").attr("class","labels"),l.append("g").attr("class","lines"),l.attr("transform","translate("+a/2+","+u/2+")");var f=t.pie().sort(null).value(function(n){return n[1]}),s=t.arc().outerRadius(.8*c).innerRadius(.4*c),g=t.select("#page-wrapper").append("div").attr("id","tooltip").style("opacity",0);n("#taxon_treeview").on("taxonSelected",function(n,t,e,u,a){i=e,o=u,r()})}var e=["#5496c4","#ffd24d","#a29cc9","#f96353","#6cc6b7","#fcac4f","#a0d643","#f99fcd","#b068b1","#b3b3b3"],o=0,i={};return{initDonutChart:r}}),!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define("d3-array",["exports"],t):t(n.d3=n.d3||{})}(this,function(n){"use strict";function t(n){return function(t,r){return o(n(t),r)}}function r(n,t,r){var e=Math.abs(t-n)/Math.max(0,r),o=Math.pow(10,Math.floor(Math.log(e)/Math.LN10)),i=e/o;return i>=E?o*=10:i>=M?o*=5:i>=_&&(o*=2),t<n?-o:o}function e(n){return n.length}var o=function(n,t){return n<t?-1:n>t?1:n>=t?0:NaN},i=function(n){return 1===n.length&&(n=t(n)),{left:function(t,r,e,o){for(null==e&&(e=0),null==o&&(o=t.length);e<o;){var i=e+o>>>1;n(t[i],r)<0?e=i+1:o=i}return e},right:function(t,r,e,o){for(null==e&&(e=0),null==o&&(o=t.length);e<o;){var i=e+o>>>1;n(t[i],r)>0?o=i:e=i+1}return e}}},u=i(o),a=u.right,c=u.left,l=function(n,t){return t<n?-1:t>n?1:t>=n?0:NaN},f=function(n){return null===n?NaN:+n},s=function(n,t){var r,e,o=n.length,i=0,u=0,a=-1,c=0;if(null==t)for(;++a<o;)isNaN(r=f(n[a]))||(e=r-i,i+=e/++c,u+=e*(r-i));else for(;++a<o;)isNaN(r=f(t(n[a],a,n)))||(e=r-i,i+=e/++c,u+=e*(r-i));if(c>1)return u/(c-1)},g=function(n,t){var r=s(n,t);return r?Math.sqrt(r):r},v=function(n,t){var r,e,o,i=-1,u=n.length;if(null==t){for(;++i<u;)if(null!=(e=n[i])&&e>=e){r=o=e;break}for(;++i<u;)null!=(e=n[i])&&(r>e&&(r=e),o<e&&(o=e))}else{for(;++i<u;)if(null!=(e=t(n[i],i,n))&&e>=e){r=o=e;break}for(;++i<u;)null!=(e=t(n[i],i,n))&&(r>e&&(r=e),o<e&&(o=e))}return[r,o]},p=Array.prototype,h=p.slice,d=p.map,y=function(n){return function(){return n}},m=function(n){return n},w=function(n,t,r){n=+n,t=+t,r=(o=arguments.length)<2?(t=n,n=0,1):o<3?1:+r;for(var e=-1,o=0|Math.max(0,Math.ceil((t-n)/r)),i=new Array(o);++e<o;)i[e]=n+e*r;return i},E=Math.sqrt(50),M=Math.sqrt(10),_=Math.sqrt(2),S=function(n,t,e){var o=r(n,t,e);return w(Math.ceil(n/o)*o,Math.floor(t/o)*o+o/2,o)},P=function(n){return Math.ceil(Math.log(n.length)/Math.LN2)+1},x=function(){function n(n){var o,i,u=n.length,c=new Array(u);for(o=0;o<u;++o)c[o]=t(n[o],o,n);var l=r(c),f=l[0],s=l[1],g=e(c,f,s);Array.isArray(g)||(g=S(f,s,g));for(var v=g.length;g[0]<=f;)g.shift(),--v;for(;g[v-1]>=s;)g.pop(),--v;var p,h=new Array(v+1);for(o=0;o<=v;++o)p=h[o]=[],p.x0=o>0?g[o-1]:f,p.x1=o<v?g[o]:s;for(o=0;o<u;++o)i=c[o],f<=i&&i<=s&&h[a(g,i,0,v)].push(n[o]);return h}var t=m,r=v,e=P;return n.value=function(r){return arguments.length?(t="function"==typeof r?r:y(r),n):t},n.domain=function(t){return arguments.length?(r="function"==typeof t?t:y([t[0],t[1]]),n):r},n.thresholds=function(t){return arguments.length?(e="function"==typeof t?t:y(Array.isArray(t)?h.call(t):t),n):e},n},b=function(n,t,r){if(null==r&&(r=f),e=n.length){if((t=+t)<=0||e<2)return+r(n[0],0,n);if(t>=1)return+r(n[e-1],e-1,n);var e,o=(e-1)*t,i=Math.floor(o),u=+r(n[i],i,n),a=+r(n[i+1],i+1,n);return u+(a-u)*(o-i)}},j=function(n,t,r){return n=d.call(n,f).sort(o),Math.ceil((r-t)/(2*(b(n,.75)-b(n,.25))*Math.pow(n.length,-1/3)))},R=function(n,t,r){return Math.ceil((r-t)/(3.5*g(n)*Math.pow(n.length,-1/3)))},A=function(n,t){var r,e,o=-1,i=n.length;if(null==t){for(;++o<i;)if(null!=(e=n[o])&&e>=e){r=e;break}for(;++o<i;)null!=(e=n[o])&&e>r&&(r=e)}else{for(;++o<i;)if(null!=(e=t(n[o],o,n))&&e>=e){r=e;break}for(;++o<i;)null!=(e=t(n[o],o,n))&&e>r&&(r=e)}return r},k=function(n,t){var r,e=0,o=n.length,i=-1,u=o;if(null==t)for(;++i<o;)isNaN(r=f(n[i]))?--u:e+=r;else for(;++i<o;)isNaN(r=f(t(n[i],i,n)))?--u:e+=r;if(u)return e/u},N=function(n,t){var r,e=[],i=n.length,u=-1;if(null==t)for(;++u<i;)isNaN(r=f(n[u]))||e.push(r);else for(;++u<i;)isNaN(r=f(t(n[u],u,n)))||e.push(r);return b(e.sort(o),.5)},C=function(n){for(var t,r,e,o=n.length,i=-1,u=0;++i<o;)u+=n[i].length;for(r=new Array(u);--o>=0;)for(e=n[o],t=e.length;--t>=0;)r[--u]=e[t];return r},G=function(n,t){var r,e,o=-1,i=n.length;if(null==t){for(;++o<i;)if(null!=(e=n[o])&&e>=e){r=e;break}for(;++o<i;)null!=(e=n[o])&&r>e&&(r=e)}else{for(;++o<i;)if(null!=(e=t(n[o],o,n))&&e>=e){r=e;break}for(;++o<i;)null!=(e=t(n[o],o,n))&&r>e&&(r=e)}return r},q=function(n){for(var t=0,r=n.length-1,e=n[0],o=new Array(r<0?0:r);t<r;)o[t]=[e,e=n[++t]];return o},L=function(n,t){for(var r=t.length,e=new Array(r);r--;)e[r]=n[t[r]];return e},z=function(n,t){if(r=n.length){var r,e,i=0,u=0,a=n[u];for(t||(t=o);++i<r;)(t(e=n[i],a)<0||0!==t(a,a))&&(a=e,u=i);return 0===t(a,a)?u:void 0}},F=function(n,t,r){for(var e,o,i=(null==r?n.length:r)-(t=null==t?0:+t);i;)o=Math.random()*i--|0,e=n[i+t],n[i+t]=n[o+t],n[o+t]=e;return n},T=function(n,t){var r,e=0,o=n.length,i=-1;if(null==t)for(;++i<o;)(r=+n[i])&&(e+=r);else for(;++i<o;)(r=+t(n[i],i,n))&&(e+=r);return e},I=function(n){if(!(i=n.length))return[];for(var t=-1,r=G(n,e),o=new Array(r);++t<r;)for(var i,u=-1,a=o[t]=new Array(i);++u<i;)a[u]=n[u][t];return o},B=function(){return I(arguments)};n.bisect=a,n.bisectRight=a,n.bisectLeft=c,n.ascending=o,n.bisector=i,n.descending=l,n.deviation=g,n.extent=v,n.histogram=x,n.thresholdFreedmanDiaconis=j,n.thresholdScott=R,n.thresholdSturges=P,n.max=A,n.mean=k,n.median=N,n.merge=C,n.min=G,n.pairs=q,n.permute=L,n.quantile=b,n.range=w,n.scan=z,n.shuffle=F,n.sum=T,n.ticks=S,n.tickStep=r,n.transpose=I,n.variance=s,n.zip=B,Object.defineProperty(n,"__esModule",{value:!0})}),function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("d3-array")):"function"==typeof define&&define.amd?define("d3-geo",["exports","d3-array"],t):t(n.d3=n.d3||{},n.d3)}(this,function(n,t){"use strict";function r(){this.reset()}function e(n,t,r){var e=n.s=t+r,o=e-t,i=e-o;n.t=t-i+(r-o)}function o(n){return n>1?0:n<-1?Lt:Math.acos(n)}function i(n){return n>1?zt:n<-1?-zt:Math.asin(n)}function u(n){return(n=Kt(n/2))*n}function a(){}function c(n,t){n&&nr.hasOwnProperty(n.type)&&nr[n.type](n,t)}function l(n,t,r){var e,o=-1,i=n.length-r;for(t.lineStart();++o<i;)e=n[o],t.point(e[0],e[1],e[2]);t.lineEnd()}function f(n,t){var r=-1,e=n.length;for(t.polygonStart();++r<e;)l(n[r],t,1);t.polygonEnd()}function s(){or.point=v}function g(){p(tt,rt)}function v(n,t){or.point=p,tt=n,rt=t,n*=Bt,t*=Bt,et=n,ot=Ot(t=t/2+Ft),it=Kt(t)}function p(n,t){n*=Bt,t*=Bt,t=t/2+Ft;var r=n-et,e=r>=0?1:-1,o=e*r,i=Ot(t),u=Kt(t),a=it*u,c=ot*i+a*Ot(o),l=a*e*Kt(o);rr.add(Wt(l,c)),et=n,ot=i,it=u}function h(n){return[Wt(n[1],n[0]),i(n[2])]}function d(n){var t=n[0],r=n[1],e=Ot(r);return[e*Ot(t),e*Kt(t),Kt(r)]}function y(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function m(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]]}function w(n,t){n[0]+=t[0],n[1]+=t[1],n[2]+=t[2]}function E(n,t){return[n[0]*t,n[1]*t,n[2]*t]}function M(n){var t=Zt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=t,n[1]/=t,n[2]/=t}function _(n,t){pt.push(ht=[ut=n,ct=n]),t<at&&(at=t),t>lt&&(lt=t)}function S(n,t){var r=d([n*Bt,t*Bt]);if(vt){var e=m(vt,r),o=[e[1],-e[0],0],i=m(o,e);M(i),i=h(i);var u,a=n-ft,c=a>0?1:-1,l=i[0]*It*c,f=Ht(a)>180;f^(c*ft<l&&l<c*n)?(u=i[1]*It,u>lt&&(lt=u)):(l=(l+360)%360-180,f^(c*ft<l&&l<c*n)?(u=-i[1]*It,u<at&&(at=u)):(t<at&&(at=t),t>lt&&(lt=t))),f?n<ft?A(ut,n)>A(ut,ct)&&(ct=n):A(n,ct)>A(ut,ct)&&(ut=n):ct>=ut?(n<ut&&(ut=n),n>ct&&(ct=n)):n>ft?A(ut,n)>A(ut,ct)&&(ct=n):A(n,ct)>A(ut,ct)&&(ut=n)}else _(n,t);vt=r,ft=n}function P(){ar.point=S}function x(){ht[0]=ut,ht[1]=ct,ar.point=_,vt=null}function b(n,t){if(vt){var r=n-ft;ur.add(Ht(r)>180?r+(r>0?360:-360):r)}else st=n,gt=t;or.point(n,t),S(n,t)}function j(){or.lineStart()}function R(){b(st,gt),or.lineEnd(),Ht(ur)>Gt&&(ut=-(ct=180)),ht[0]=ut,ht[1]=ct,vt=null}function A(n,t){return(t-=n)<0?t+360:t}function k(n,t){return n[0]-t[0]}function N(n,t){return n[0]<=n[1]?n[0]<=t&&t<=n[1]:t<n[0]||n[1]<t}function C(n,t){n*=Bt,t*=Bt;var r=Ot(t);G(r*Ot(n),r*Kt(n),Kt(t))}function G(n,t,r){++dt,mt+=(n-mt)/dt,wt+=(t-wt)/dt,Et+=(r-Et)/dt}function q(){lr.point=L}function L(n,t){n*=Bt,t*=Bt;var r=Ot(t);At=r*Ot(n),kt=r*Kt(n),Nt=Kt(t),lr.point=z,G(At,kt,Nt)}function z(n,t){n*=Bt,t*=Bt;var r=Ot(t),e=r*Ot(n),o=r*Kt(n),i=Kt(t),u=Wt(Zt((u=kt*i-Nt*o)*u+(u=Nt*e-At*i)*u+(u=At*o-kt*e)*u),At*e+kt*o+Nt*i);yt+=u,Mt+=u*(At+(At=e)),_t+=u*(kt+(kt=o)),St+=u*(Nt+(Nt=i)),G(At,kt,Nt)}function F(){lr.point=C}function T(){lr.point=B}function I(){H(jt,Rt),lr.point=C}function B(n,t){jt=n,Rt=t,n*=Bt,t*=Bt,lr.point=H;var r=Ot(t);At=r*Ot(n),kt=r*Kt(n),Nt=Kt(t),G(At,kt,Nt)}function H(n,t){n*=Bt,t*=Bt;var r=Ot(t),e=r*Ot(n),i=r*Kt(n),u=Kt(t),a=kt*u-Nt*i,c=Nt*e-At*u,l=At*i-kt*e,f=Zt(a*a+c*c+l*l),s=At*e+kt*i+Nt*u,g=f&&-o(s)/f,v=Wt(f,s);Pt+=g*a,xt+=g*c,bt+=g*l,yt+=v,Mt+=v*(At+(At=e)),_t+=v*(kt+(kt=i)),St+=v*(Nt+(Nt=u)),G(At,kt,Nt)}function D(n,t){return[n>Lt?n-Tt:n<-Lt?n+Tt:n,t]}function W(n,t,r){return(n%=Tt)?t||r?gr(Q(n),V(t,r)):Q(n):t||r?V(t,r):D}function O(n){return function(t,r){return t+=n,[t>Lt?t-Tt:t<-Lt?t+Tt:t,r]}}function Q(n){var t=O(n);return t.invert=O(-n),t}function V(n,t){function r(n,t){var r=Ot(t),c=Ot(n)*r,l=Kt(n)*r,f=Kt(t),s=f*e+c*o;return[Wt(l*u-s*a,c*e-f*o),i(s*u+l*a)]}var e=Ot(n),o=Kt(n),u=Ot(t),a=Kt(t);return r.invert=function(n,t){var r=Ot(t),c=Ot(n)*r,l=Kt(n)*r,f=Kt(t),s=f*u-l*a;return[Wt(l*u+f*a,c*e+s*o),i(s*e-c*o)]},r}function U(n,t,r,e,o,i){if(r){var u=Ot(t),a=Kt(t),c=e*r;null==o?(o=t+e*Tt,i=t-c/2):(o=Y(u,o),i=Y(u,i),(e>0?o<i:o>i)&&(o+=e*Tt));for(var l,f=o;e>0?f>i:f<i;f-=c)l=h([u,-a*Ot(f),-a*Kt(f)]),n.point(l[0],l[1])}}function Y(n,t){t=d(t),t[0]-=n,M(t);var r=o(-t[1]);return((-t[2]<0?-r:r)+Tt-Gt)%Tt}function K(n,t,r,e){this.x=n,this.z=t,this.o=r,this.e=e,this.v=!1,this.n=this.p=null}function X(n){if(t=n.length){for(var t,r,e=0,o=n[0];++e<t;)o.n=r=n[e],r.p=o,o=r;o.n=r=n[0],r.p=o}}function Z(n,r,e,o){function i(t,i){return n<=t&&t<=e&&r<=i&&i<=o}function u(t,i,u,c){var f=0,s=0;if(null==t||(f=a(t,u))!==(s=a(i,u))||l(t,i)<0^u>0){do c.point(0===f||3===f?n:e,f>1?o:r);while((f=(f+u+4)%4)!==s)}else c.point(i[0],i[1])}function a(t,o){return Ht(t[0]-n)<Gt?o>0?0:3:Ht(t[0]-e)<Gt?o>0?2:1:Ht(t[1]-r)<Gt?o>0?1:0:o>0?3:2}function c(n,t){return l(n.x,t.x)}function l(n,t){var r=a(n,1),e=a(t,1);return r!==e?r-e:0===r?t[1]-n[1]:1===r?n[0]-t[0]:2===r?n[1]-t[1]:t[0]-n[0]}return function(a){function l(n,t){i(n,t)&&j.point(n,t)}function f(){for(var t=0,r=0,e=y.length;r<e;++r)for(var i,u,a=y[r],c=1,l=a.length,f=a[0],s=f[0],g=f[1];c<l;++c)i=s,u=g,f=a[c],s=f[0],g=f[1],u<=o?g>o&&(s-i)*(o-u)>(g-u)*(n-i)&&++t:g<=o&&(s-i)*(o-u)<(g-u)*(n-i)&&--t;return t}function s(){j=R,d=[],y=[],b=!0}function g(){var n=f(),r=b&&n,e=(d=t.merge(d)).length;(r||e)&&(a.polygonStart(),r&&(a.lineStart(),u(null,null,1,a),a.lineEnd()),e&&Ar(d,c,n,u,a),a.polygonEnd()),j=a,d=y=m=null}function v(){A.point=h,y&&y.push(m=[]),x=!0,P=!1,_=S=NaN}function p(){d&&(h(w,E),M&&P&&R.rejoin(),d.push(R.result())),A.point=l,P&&j.lineEnd()}function h(t,u){var a=i(t,u);if(y&&m.push([t,u]),x)w=t,E=u,M=a,x=!1,a&&(j.lineStart(),j.point(t,u));else if(a&&P)j.point(t,u);else{var c=[_=Math.max(Nr,Math.min(kr,_)),S=Math.max(Nr,Math.min(kr,S))],l=[t=Math.max(Nr,Math.min(kr,t)),u=Math.max(Nr,Math.min(kr,u))];jr(c,l,n,r,e,o)?(P||(j.lineStart(),j.point(c[0],c[1])),j.point(l[0],l[1]),a||j.lineEnd(),b=!1):a&&(j.lineStart(),j.point(t,u),b=!1)}_=t,S=u,P=a}var d,y,m,w,E,M,_,S,P,x,b,j=a,R=br(),A={point:l,lineStart:v,lineEnd:p,polygonStart:s,polygonEnd:g};return A}}function $(){qr.point=nn,qr.lineEnd=J}function J(){qr.point=qr.lineEnd=a}function nn(n,t){n*=Bt,t*=Bt,vr=n,pr=Kt(t),hr=Ot(t),qr.point=tn}function tn(n,t){n*=Bt,t*=Bt;var r=Kt(t),e=Ot(t),o=Ht(n-vr),i=Ot(o),u=Kt(o),a=e*u,c=hr*r-pr*e*i,l=pr*r+hr*e*i;Gr.add(Wt(Zt(a*a+c*c),l)),vr=n,pr=r,hr=e}function rn(n,r,e){var o=t.range(n,r-Gt,e).concat(r);return function(n){return o.map(function(t){return[n,t]})}}function en(n,r,e){var o=t.range(n,r-Gt,e).concat(r);return function(n){return o.map(function(t){return[t,n]})}}function on(){function n(){return{type:"MultiLineString",coordinates:r()}}function r(){return t.range(Qt(u/y)*y,i,y).map(v).concat(t.range(Qt(f/m)*m,l,m).map(p)).concat(t.range(Qt(o/h)*h,e,h).filter(function(n){return Ht(n%y)>Gt}).map(s)).concat(t.range(Qt(c/d)*d,a,d).filter(function(n){return Ht(n%m)>Gt}).map(g))}var e,o,i,u,a,c,l,f,s,g,v,p,h=10,d=h,y=90,m=360,w=2.5;return n.lines=function(){return r().map(function(n){return{type:"LineString",coordinates:n}})},n.outline=function(){return{type:"Polygon",coordinates:[v(u).concat(p(l).slice(1),v(i).reverse().slice(1),p(f).reverse().slice(1))]}},n.extent=function(t){return arguments.length?n.extentMajor(t).extentMinor(t):n.extentMinor()},n.extentMajor=function(t){return arguments.length?(u=+t[0][0],i=+t[1][0],f=+t[0][1],l=+t[1][1],u>i&&(t=u,u=i,i=t),f>l&&(t=f,f=l,l=t),n.precision(w)):[[u,f],[i,l]]},n.extentMinor=function(t){return arguments.length?(o=+t[0][0],e=+t[1][0],c=+t[0][1],a=+t[1][1],o>e&&(t=o,o=e,e=t),c>a&&(t=c,c=a,a=t),n.precision(w)):[[o,c],[e,a]]},n.step=function(t){return arguments.length?n.stepMajor(t).stepMinor(t):n.stepMinor()},n.stepMajor=function(t){return arguments.length?(y=+t[0],m=+t[1],n):[y,m]},n.stepMinor=function(t){return arguments.length?(h=+t[0],d=+t[1],n):[h,d]},n.precision=function(t){return arguments.length?(w=+t,s=rn(c,a,90),g=en(o,e,w),v=rn(f,l,90),p=en(u,i,w),n):w},n.extentMajor([[-180,-90+Gt],[180,90-Gt]]).extentMinor([[-180,-80-Gt],[180,80+Gt]])}function un(){return on()()}function an(){Wr.point=cn}function cn(n,t){Wr.point=ln,dr=mr=n,yr=wr=t}function ln(n,t){Dr.add(wr*n-mr*t),mr=n,wr=t}function fn(){ln(dr,yr)}function sn(n,t){n<Or&&(Or=n),n>Vr&&(Vr=n),t<Qr&&(Qr=t),t>Ur&&(Ur=t)}function gn(n,t){Kr+=n,Xr+=t,++Zr}function vn(){oe.point=pn}function pn(n,t){oe.point=hn,gn(_r=n,Sr=t)}function hn(n,t){var r=n-_r,e=t-Sr,o=Zt(r*r+e*e);$r+=o*(_r+n)/2,Jr+=o*(Sr+t)/2,ne+=o,gn(_r=n,Sr=t)}function dn(){oe.point=gn}function yn(){oe.point=wn}function mn(){En(Er,Mr)}function wn(n,t){oe.point=En,gn(Er=_r=n,Mr=Sr=t)}function En(n,t){var r=n-_r,e=t-Sr,o=Zt(r*r+e*e);$r+=o*(_r+n)/2,Jr+=o*(Sr+t)/2,ne+=o,o=Sr*n-_r*t,te+=o*(_r+n),re+=o*(Sr+t),ee+=3*o,gn(_r=n,Sr=t)}function Mn(n){this._context=n}function _n(){this._string=[]}function Sn(n){return"m0,"+n+"a"+n+","+n+" 0 1,1 0,"+-2*n+"a"+n+","+n+" 0 1,1 0,"+2*n+"z"}function Pn(n){return n.length>1}function xn(n,t){return((n=n.x)[0]<0?n[1]-zt-Gt:zt-n[1])-((t=t.x)[0]<0?t[1]-zt-Gt:zt-t[1])}function bn(n){var t,r=NaN,e=NaN,o=NaN;return{lineStart:function(){n.lineStart(),t=1},point:function(i,u){var a=i>0?Lt:-Lt,c=Ht(i-r);Ht(c-Lt)<Gt?(n.point(r,e=(e+u)/2>0?zt:-zt),n.point(o,e),n.lineEnd(),n.lineStart(),n.point(a,e),n.point(i,e),t=0):o!==a&&c>=Lt&&(Ht(r-o)<Gt&&(r-=o*Gt),Ht(i-a)<Gt&&(i-=a*Gt),e=jn(r,e,i,u),n.point(o,e),n.lineEnd(),n.lineStart(),n.point(a,e),t=0),n.point(r=i,e=u),o=a},lineEnd:function(){n.lineEnd(),r=e=NaN},clean:function(){return 2-t}}}function jn(n,t,r,e){var o,i,u=Kt(n-r);return Ht(u)>Gt?Dt((Kt(t)*(i=Ot(e))*Kt(r)-Kt(e)*(o=Ot(t))*Kt(n))/(o*i*u)):(t+e)/2}function Rn(n,t,r,e){var o;if(null==n)o=r*zt,e.point(-Lt,o),e.point(0,o),e.point(Lt,o),e.point(Lt,0),e.point(Lt,-o),e.point(0,-o),e.point(-Lt,-o),e.point(-Lt,0),e.point(-Lt,o);else if(Ht(n[0]-t[0])>Gt){var i=n[0]<t[0]?Lt:-Lt;o=r*i/2,e.point(-i,o),e.point(0,o),e.point(i,o)}else e.point(t[0],t[1])}function An(n){return function(t){var r=new kn;for(var e in n)r[e]=n[e];return r.stream=t,r}}function kn(){}function Nn(n,t,r){var e=t[1][0]-t[0][0],o=t[1][1]-t[0][1],i=n.clipExtent&&n.clipExtent();n.scale(150).translate([0,0]),null!=i&&n.clipExtent(null),tr(r,n.stream(Yr));var u=Yr.result(),a=Math.min(e/(u[1][0]-u[0][0]),o/(u[1][1]-u[0][1])),c=+t[0][0]+(e-a*(u[1][0]+u[0][0]))/2,l=+t[0][1]+(o-a*(u[1][1]+u[0][1]))/2;return null!=i&&n.clipExtent(i),n.scale(150*a).translate([c,l])}function Cn(n,t,r){return Nn(n,[[0,0],t],r)}function Gn(n){return An({point:function(t,r){t=n(t,r),this.stream.point(t[0],t[1])}})}function qn(n,t){function r(e,o,u,a,c,l,f,s,g,v,p,h,d,y){var m=f-e,w=s-o,E=m*m+w*w;if(E>4*t&&d--){var M=a+v,_=c+p,S=l+h,P=Zt(M*M+_*_+S*S),x=i(S/=P),b=Ht(Ht(S)-1)<Gt||Ht(u-g)<Gt?(u+g)/2:Wt(_,M),j=n(b,x),R=j[0],A=j[1],k=R-e,N=A-o,C=w*k-m*N;(C*C/E>t||Ht((m*k+w*N)/E-.5)>.3||a*v+c*p+l*h<ve)&&(r(e,o,u,a,c,l,R,A,b,M/=P,_/=P,S,d,y),y.point(R,A),r(R,A,b,M,_,S,f,s,g,v,p,h,d,y))}}return function(t){function e(r,e){r=n(r,e),t.point(r[0],r[1])}function o(){m=NaN,S.point=i,t.lineStart()}function i(e,o){var i=d([e,o]),u=n(e,o);r(m,w,y,E,M,_,m=u[0],w=u[1],y=e,E=i[0],M=i[1],_=i[2],ge,t),t.point(m,w)}function u(){S.point=e,t.lineEnd()}function a(){o(),S.point=c,S.lineEnd=l}function c(n,t){i(f=n,t),s=m,g=w,v=E,p=M,h=_,S.point=i}function l(){r(m,w,y,E,M,_,s,g,f,v,p,h,ge,t),S.lineEnd=u,u()}var f,s,g,v,p,h,y,m,w,E,M,_,S={point:e,lineStart:o,lineEnd:u,polygonStart:function(){t.polygonStart(),S.lineStart=a},polygonEnd:function(){t.polygonEnd(),S.lineStart=o}};return S}}function Ln(n){return zn(function(){return n})()}function zn(n){function t(n){return n=f(n[0]*Bt,n[1]*Bt),[n[0]*d+a,c-n[1]*d]}function r(n){return n=f.invert((n[0]-a)/d,(c-n[1])/d),n&&[n[0]*It,n[1]*It]}function e(n,t){return n=u(n,t),[n[0]*d+a,c-n[1]*d]}function o(){f=gr(l=W(M,_,S),u);var n=u(w,E);return a=y-n[0]*d,c=m+n[1]*d,i()}function i(){return p=h=null,t}var u,a,c,l,f,s,g,v,p,h,d=150,y=480,m=250,w=0,E=0,M=0,_=0,S=0,P=null,x=le,b=null,j=Br,R=.5,A=pe(e,R);return t.stream=function(n){return p&&h===n?p:p=he(x(l,A(j(h=n))))},t.clipAngle=function(n){return arguments.length?(x=+n?fe(P=n*Bt,6*Bt):(P=null,le),i()):P*It},t.clipExtent=function(n){return arguments.length?(j=null==n?(b=s=g=v=null,Br):Z(b=+n[0][0],s=+n[0][1],g=+n[1][0],v=+n[1][1]),i()):null==b?null:[[b,s],[g,v]]},t.scale=function(n){return arguments.length?(d=+n,o()):d},t.translate=function(n){return arguments.length?(y=+n[0],m=+n[1],o()):[y,m]},t.center=function(n){return arguments.length?(w=n[0]%360*Bt,E=n[1]%360*Bt,o()):[w*It,E*It]},t.rotate=function(n){return arguments.length?(M=n[0]%360*Bt,_=n[1]%360*Bt,S=n.length>2?n[2]%360*Bt:0,o()):[M*It,_*It,S*It]},t.precision=function(n){return arguments.length?(A=pe(e,R=n*n),i()):Zt(R)},t.fitExtent=function(n,r){return Nn(t,n,r)},t.fitSize=function(n,r){return Cn(t,n,r)},function(){return u=n.apply(this,arguments),t.invert=u.invert&&r,o()}}function Fn(n){var t=0,r=Lt/3,e=zn(n),o=e(t,r);return o.parallels=function(n){return arguments.length?e(t=n[0]*Bt,r=n[1]*Bt):[t*It,r*It]},o}function Tn(n){function t(n,t){return[n*r,Kt(t)/r]}var r=Ot(n);return t.invert=function(n,t){return[n/r,i(t*r)]},t}function In(n,t){function r(n,t){var r=Zt(u-2*o*Kt(t))/o;return[r*Kt(n*=o),a-r*Ot(n)]}var e=Kt(n),o=(e+Kt(t))/2;if(Ht(o)<Gt)return Tn(n);var u=1+e*(2*o-e),a=Zt(u)/o;return r.invert=function(n,t){var r=a-t;return[Wt(n,Ht(r))/o*Xt(r),i((u-(n*n+r*r)*o*o)/(2*o))]},r}function Bn(n){var t=n.length;return{point:function(r,e){for(var o=-1;++o<t;)n[o].point(r,e)},sphere:function(){for(var r=-1;++r<t;)n[r].sphere()},lineStart:function(){for(var r=-1;++r<t;)n[r].lineStart()},lineEnd:function(){for(var r=-1;++r<t;)n[r].lineEnd()},polygonStart:function(){for(var r=-1;++r<t;)n[r].polygonStart()},polygonEnd:function(){for(var r=-1;++r<t;)n[r].polygonEnd()}}}function Hn(n){return function(t,r){var e=Ot(t),o=Ot(r),i=n(e*o);return[i*o*Kt(t),i*Kt(r)]}}function Dn(n){return function(t,r){var e=Zt(t*t+r*r),o=n(e),u=Kt(o),a=Ot(o);return[Wt(t*u,e*a),i(e&&r*u/e)]}}function Wn(n,t){return[n,Ut($t((zt+t)/2))]}function On(n){var t,r=Ln(n),e=r.scale,o=r.translate,i=r.clipExtent;return r.scale=function(n){return arguments.length?(e(n),t&&r.clipExtent(null),r):e()},r.translate=function(n){return arguments.length?(o(n),t&&r.clipExtent(null),r):o()},r.clipExtent=function(n){if(!arguments.length)return t?null:i();if(t=null==n){var u=Lt*e(),a=o();n=[[a[0]-u,a[1]-u],[a[0]+u,a[1]+u]]}return i(n),r},r.clipExtent(null)}function Qn(n){return $t((zt+n)/2)}function Vn(n,t){function r(n,t){i>0?t<-zt+Gt&&(t=-zt+Gt):t>zt-Gt&&(t=zt-Gt);var r=i/Yt(Qn(t),o);return[r*Kt(o*n),i-r*Ot(o*n)]}var e=Ot(n),o=n===t?Kt(n):Ut(e/Ot(t))/Ut(Qn(t)/Qn(n)),i=e*Yt(Qn(n),o)/o;return o?(r.invert=function(n,t){var r=i-t,e=Xt(o)*Zt(n*n+r*r);return[Wt(n,Ht(r))/o*Xt(r),2*Dt(Yt(i/e,1/o))-zt]},r):Wn}function Un(n,t){return[n,t]}function Yn(n,t){function r(n,t){var r=i-t,e=o*n;return[r*Kt(e),i-r*Ot(e)]}var e=Ot(n),o=n===t?Kt(n):(e-Ot(t))/(t-n),i=e/o+n;return Ht(o)<Gt?Un:(r.invert=function(n,t){var r=i-t;return[Wt(n,Ht(r))/o*Xt(r),i-Xt(o)*Zt(n*n+r*r)]},r)}function Kn(n,t){var r=Ot(t),e=Ot(n)*r;return[r*Kt(n)/e,Kt(t)/e]}function Xn(n,t,r,e){return 1===n&&1===t&&0===r&&0===e?Br:An({point:function(o,i){this.stream.point(o*n+r,i*t+e)}})}function Zn(n,t){return[Ot(t)*Kt(n),Kt(t)]}function $n(n,t){var r=Ot(t),e=1+Ot(n)*r;return[r*Kt(n)/e,Kt(t)/e]}function Jn(n,t){return[Ut($t((zt+t)/2)),-n]}var nt=function(){return new r};r.prototype={constructor:r,reset:function(){this.s=this.t=0},add:function(n){e(Ct,n,this.t),e(this,Ct.s,this.s),this.s?this.t+=Ct.t:this.s=Ct.t},valueOf:function(){return this.s}};var tt,rt,et,ot,it,ut,at,ct,lt,ft,st,gt,vt,pt,ht,dt,yt,mt,wt,Et,Mt,_t,St,Pt,xt,bt,jt,Rt,At,kt,Nt,Ct=new r,Gt=1e-6,qt=1e-12,Lt=Math.PI,zt=Lt/2,Ft=Lt/4,Tt=2*Lt,It=180/Lt,Bt=Lt/180,Ht=Math.abs,Dt=Math.atan,Wt=Math.atan2,Ot=Math.cos,Qt=Math.ceil,Vt=Math.exp,Ut=Math.log,Yt=Math.pow,Kt=Math.sin,Xt=Math.sign||function(n){return n>0?1:n<0?-1:0},Zt=Math.sqrt,$t=Math.tan,Jt={Feature:function(n,t){c(n.geometry,t)},FeatureCollection:function(n,t){for(var r=n.features,e=-1,o=r.length;++e<o;)c(r[e].geometry,t)}},nr={Sphere:function(n,t){t.sphere()},Point:function(n,t){n=n.coordinates,t.point(n[0],n[1],n[2])},MultiPoint:function(n,t){for(var r=n.coordinates,e=-1,o=r.length;++e<o;)n=r[e],t.point(n[0],n[1],n[2])},LineString:function(n,t){l(n.coordinates,t,0)},MultiLineString:function(n,t){for(var r=n.coordinates,e=-1,o=r.length;++e<o;)l(r[e],t,0)},Polygon:function(n,t){f(n.coordinates,t)},MultiPolygon:function(n,t){for(var r=n.coordinates,e=-1,o=r.length;++e<o;)f(r[e],t)},GeometryCollection:function(n,t){for(var r=n.geometries,e=-1,o=r.length;++e<o;)c(r[e],t)}},tr=function(n,t){n&&Jt.hasOwnProperty(n.type)?Jt[n.type](n,t):c(n,t)},rr=nt(),er=nt(),or={point:a,lineStart:a,lineEnd:a,polygonStart:function(){rr.reset(),or.lineStart=s,or.lineEnd=g},polygonEnd:function(){var n=+rr;er.add(n<0?Tt+n:n),this.lineStart=this.lineEnd=this.point=a},sphere:function(){er.add(Tt)}},ir=function(n){return er.reset(),tr(n,or),2*er},ur=nt(),ar={point:_,lineStart:P,lineEnd:x,polygonStart:function(){ar.point=b,ar.lineStart=j,ar.lineEnd=R,ur.reset(),or.polygonStart()},polygonEnd:function(){or.polygonEnd(),ar.point=_,ar.lineStart=P,ar.lineEnd=x,rr<0?(ut=-(ct=180),at=-(lt=90)):ur>Gt?lt=90:ur<-Gt&&(at=-90),ht[0]=ut,ht[1]=ct}},cr=function(n){var t,r,e,o,i,u,a;if(lt=ct=-(ut=at=1/0),pt=[],tr(n,ar),r=pt.length){for(pt.sort(k),t=1,e=pt[0],i=[e];t<r;++t)o=pt[t],
N(e,o[0])||N(e,o[1])?(A(e[0],o[1])>A(e[0],e[1])&&(e[1]=o[1]),A(o[0],e[1])>A(e[0],e[1])&&(e[0]=o[0])):i.push(e=o);for(u=-(1/0),r=i.length-1,t=0,e=i[r];t<=r;e=o,++t)o=i[t],(a=A(e[1],o[0]))>u&&(u=a,ut=o[0],ct=e[1])}return pt=ht=null,ut===1/0||at===1/0?[[NaN,NaN],[NaN,NaN]]:[[ut,at],[ct,lt]]},lr={sphere:a,point:C,lineStart:q,lineEnd:F,polygonStart:function(){lr.lineStart=T,lr.lineEnd=I},polygonEnd:function(){lr.lineStart=q,lr.lineEnd=F}},fr=function(n){dt=yt=mt=wt=Et=Mt=_t=St=Pt=xt=bt=0,tr(n,lr);var t=Pt,r=xt,e=bt,o=t*t+r*r+e*e;return o<qt&&(t=Mt,r=_t,e=St,yt<Gt&&(t=mt,r=wt,e=Et),o=t*t+r*r+e*e,o<qt)?[NaN,NaN]:[Wt(r,t)*It,i(e/Zt(o))*It]},sr=function(n){return function(){return n}},gr=function(n,t){function r(r,e){return r=n(r,e),t(r[0],r[1])}return n.invert&&t.invert&&(r.invert=function(r,e){return r=t.invert(r,e),r&&n.invert(r[0],r[1])}),r};D.invert=D;var vr,pr,hr,dr,yr,mr,wr,Er,Mr,_r,Sr,Pr=function(n){function t(t){return t=n(t[0]*Bt,t[1]*Bt),t[0]*=It,t[1]*=It,t}return n=W(n[0]*Bt,n[1]*Bt,n.length>2?n[2]*Bt:0),t.invert=function(t){return t=n.invert(t[0]*Bt,t[1]*Bt),t[0]*=It,t[1]*=It,t},t},xr=function(){function n(n,t){r.push(n=e(n,t)),n[0]*=It,n[1]*=It}function t(){var n=o.apply(this,arguments),t=i.apply(this,arguments)*Bt,c=u.apply(this,arguments)*Bt;return r=[],e=W(-n[0]*Bt,-n[1]*Bt,0).invert,U(a,t,c,1),n={type:"Polygon",coordinates:[r]},r=e=null,n}var r,e,o=sr([0,0]),i=sr(90),u=sr(6),a={point:n};return t.center=function(n){return arguments.length?(o="function"==typeof n?n:sr([+n[0],+n[1]]),t):o},t.radius=function(n){return arguments.length?(i="function"==typeof n?n:sr(+n),t):i},t.precision=function(n){return arguments.length?(u="function"==typeof n?n:sr(+n),t):u},t},br=function(){var n,t=[];return{point:function(t,r){n.push([t,r])},lineStart:function(){t.push(n=[])},lineEnd:a,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var r=t;return t=[],n=null,r}}},jr=function(n,t,r,e,o,i){var u,a=n[0],c=n[1],l=t[0],f=t[1],s=0,g=1,v=l-a,p=f-c;if(u=r-a,v||!(u>0)){if(u/=v,v<0){if(u<s)return;u<g&&(g=u)}else if(v>0){if(u>g)return;u>s&&(s=u)}if(u=o-a,v||!(u<0)){if(u/=v,v<0){if(u>g)return;u>s&&(s=u)}else if(v>0){if(u<s)return;u<g&&(g=u)}if(u=e-c,p||!(u>0)){if(u/=p,p<0){if(u<s)return;u<g&&(g=u)}else if(p>0){if(u>g)return;u>s&&(s=u)}if(u=i-c,p||!(u<0)){if(u/=p,p<0){if(u>g)return;u>s&&(s=u)}else if(p>0){if(u<s)return;u<g&&(g=u)}return s>0&&(n[0]=a+s*v,n[1]=c+s*p),g<1&&(t[0]=a+g*v,t[1]=c+g*p),!0}}}}},Rr=function(n,t){return Ht(n[0]-t[0])<Gt&&Ht(n[1]-t[1])<Gt},Ar=function(n,t,r,e,o){var i,u,a=[],c=[];if(n.forEach(function(n){if(!((t=n.length-1)<=0)){var t,r,e=n[0],u=n[t];if(Rr(e,u)){for(o.lineStart(),i=0;i<t;++i)o.point((e=n[i])[0],e[1]);return void o.lineEnd()}a.push(r=new K(e,n,null,!0)),c.push(r.o=new K(e,null,r,!1)),a.push(r=new K(u,n,null,!1)),c.push(r.o=new K(u,null,r,!0))}}),a.length){for(c.sort(t),X(a),X(c),i=0,u=c.length;i<u;++i)c[i].e=r=!r;for(var l,f,s=a[0];;){for(var g=s,v=!0;g.v;)if((g=g.n)===s)return;l=g.z,o.lineStart();do{if(g.v=g.o.v=!0,g.e){if(v)for(i=0,u=l.length;i<u;++i)o.point((f=l[i])[0],f[1]);else e(g.x,g.n.x,1,o);g=g.n}else{if(v)for(l=g.p.z,i=l.length-1;i>=0;--i)o.point((f=l[i])[0],f[1]);else e(g.x,g.p.x,-1,o);g=g.p}g=g.o,l=g.z,v=!v}while(!g.v);o.lineEnd()}}},kr=1e9,Nr=-kr,Cr=function(){var n,t,r,e=0,o=0,i=960,u=500;return r={stream:function(r){return n&&t===r?n:n=Z(e,o,i,u)(t=r)},extent:function(a){return arguments.length?(e=+a[0][0],o=+a[0][1],i=+a[1][0],u=+a[1][1],n=t=null,r):[[e,o],[i,u]]}}},Gr=nt(),qr={sphere:a,point:a,lineStart:$,lineEnd:a,polygonStart:a,polygonEnd:a},Lr=function(n){return Gr.reset(),tr(n,qr),+Gr},zr=[null,null],Fr={type:"LineString",coordinates:zr},Tr=function(n,t){return zr[0]=n,zr[1]=t,Lr(Fr)},Ir=function(n,t){var r=n[0]*Bt,e=n[1]*Bt,o=t[0]*Bt,a=t[1]*Bt,c=Ot(e),l=Kt(e),f=Ot(a),s=Kt(a),g=c*Ot(r),v=c*Kt(r),p=f*Ot(o),h=f*Kt(o),d=2*i(Zt(u(a-e)+c*f*u(o-r))),y=Kt(d),m=d?function(n){var t=Kt(n*=d)/y,r=Kt(d-n)/y,e=r*g+t*p,o=r*v+t*h,i=r*l+t*s;return[Wt(o,e)*It,Wt(i,Zt(e*e+o*o))*It]}:function(){return[r*It,e*It]};return m.distance=d,m},Br=function(n){return n},Hr=nt(),Dr=nt(),Wr={point:a,lineStart:a,lineEnd:a,polygonStart:function(){Wr.lineStart=an,Wr.lineEnd=fn},polygonEnd:function(){Wr.lineStart=Wr.lineEnd=Wr.point=a,Hr.add(Ht(Dr)),Dr.reset()},result:function(){var n=Hr/2;return Hr.reset(),n}},Or=1/0,Qr=Or,Vr=-Or,Ur=Vr,Yr={point:sn,lineStart:a,lineEnd:a,polygonStart:a,polygonEnd:a,result:function(){var n=[[Or,Qr],[Vr,Ur]];return Vr=Ur=-(Qr=Or=1/0),n}},Kr=0,Xr=0,Zr=0,$r=0,Jr=0,ne=0,te=0,re=0,ee=0,oe={point:gn,lineStart:vn,lineEnd:dn,polygonStart:function(){oe.lineStart=yn,oe.lineEnd=mn},polygonEnd:function(){oe.point=gn,oe.lineStart=vn,oe.lineEnd=dn},result:function(){var n=ee?[te/ee,re/ee]:ne?[$r/ne,Jr/ne]:Zr?[Kr/Zr,Xr/Zr]:[NaN,NaN];return Kr=Xr=Zr=$r=Jr=ne=te=re=ee=0,n}};Mn.prototype={_radius:4.5,pointRadius:function(n){return this._radius=n,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(n,t){switch(this._point){case 0:this._context.moveTo(n,t),this._point=1;break;case 1:this._context.lineTo(n,t);break;default:this._context.moveTo(n+this._radius,t),this._context.arc(n,t,this._radius,0,Tt)}},result:a},_n.prototype={_circle:Sn(4.5),pointRadius:function(n){return this._circle=Sn(n),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(n,t){switch(this._point){case 0:this._string.push("M",n,",",t),this._point=1;break;case 1:this._string.push("L",n,",",t);break;default:this._string.push("M",n,",",t,this._circle)}},result:function(){if(this._string.length){var n=this._string.join("");return this._string=[],n}}};var ie=function(n,t){function r(n){return n&&("function"==typeof i&&o.pointRadius(+i.apply(this,arguments)),tr(n,e(o))),o.result()}var e,o,i=4.5;return r.area=function(n){return tr(n,e(Wr)),Wr.result()},r.bounds=function(n){return tr(n,e(Yr)),Yr.result()},r.centroid=function(n){return tr(n,e(oe)),oe.result()},r.projection=function(t){return arguments.length?(e=null==t?(n=null,Br):(n=t).stream,r):n},r.context=function(n){return arguments.length?(o=null==n?(t=null,new _n):new Mn(t=n),"function"!=typeof i&&o.pointRadius(i),r):t},r.pointRadius=function(n){return arguments.length?(i="function"==typeof n?n:(o.pointRadius(+n),+n),r):i},r.projection(n).context(t)},ue=nt(),ae=function(n,t){var r=t[0],e=t[1],o=[Kt(r),-Ot(r),0],u=0,a=0;ue.reset();for(var c=0,l=n.length;c<l;++c)if(s=(f=n[c]).length)for(var f,s,g=f[s-1],v=g[0],p=g[1]/2+Ft,h=Kt(p),y=Ot(p),w=0;w<s;++w,v=_,h=P,y=x,g=E){var E=f[w],_=E[0],S=E[1]/2+Ft,P=Kt(S),x=Ot(S),b=_-v,j=b>=0?1:-1,R=j*b,A=R>Lt,k=h*P;if(ue.add(Wt(k*j*Kt(R),y*x+k*Ot(R))),u+=A?b+j*Tt:b,A^v>=r^_>=r){var N=m(d(g),d(E));M(N);var C=m(o,N);M(C);var G=(A^b>=0?-1:1)*i(C[2]);(e>G||e===G&&(N[0]||N[1]))&&(a+=A^b>=0?1:-1)}}return(u<-Gt||u<Gt&&ue<-Gt)^1&a},ce=function(n,r,e,o){return function(i,u){function a(t,r){var e=i(t,r);n(t=e[0],r=e[1])&&u.point(t,r)}function c(n,t){var r=i(n,t);y.point(r[0],r[1])}function l(){_.point=c,y.lineStart()}function f(){_.point=a,y.lineEnd()}function s(n,t){d.push([n,t]);var r=i(n,t);E.point(r[0],r[1])}function g(){E.lineStart(),d=[]}function v(){s(d[0][0],d[0][1]),E.lineEnd();var n,t,r,e,o=E.clean(),i=w.result(),a=i.length;if(d.pop(),p.push(d),d=null,a)if(1&o){if(r=i[0],(t=r.length-1)>0){for(M||(u.polygonStart(),M=!0),u.lineStart(),n=0;n<t;++n)u.point((e=r[n])[0],e[1]);u.lineEnd()}}else a>1&&2&o&&i.push(i.pop().concat(i.shift())),h.push(i.filter(Pn))}var p,h,d,y=r(u),m=i.invert(o[0],o[1]),w=br(),E=r(w),M=!1,_={point:a,lineStart:l,lineEnd:f,polygonStart:function(){_.point=s,_.lineStart=g,_.lineEnd=v,h=[],p=[]},polygonEnd:function(){_.point=a,_.lineStart=l,_.lineEnd=f,h=t.merge(h);var n=ae(p,m);h.length?(M||(u.polygonStart(),M=!0),Ar(h,xn,n,e,u)):n&&(M||(u.polygonStart(),M=!0),u.lineStart(),e(null,null,1,u),u.lineEnd()),M&&(u.polygonEnd(),M=!1),h=p=null},sphere:function(){u.polygonStart(),u.lineStart(),e(null,null,1,u),u.lineEnd(),u.polygonEnd()}};return _}},le=ce(function(){return!0},bn,Rn,[-Lt,-zt]),fe=function(n,t){function r(r,e,o,i){U(i,n,t,o,r,e)}function e(n,t){return Ot(n)*Ot(t)>a}function o(n){var t,r,o,a,f;return{lineStart:function(){a=o=!1,f=1},point:function(s,g){var v,p=[s,g],h=e(s,g),d=c?h?0:u(s,g):h?u(s+(s<0?Lt:-Lt),g):0;if(!t&&(a=o=h)&&n.lineStart(),h!==o&&(v=i(t,p),(Rr(t,v)||Rr(p,v))&&(p[0]+=Gt,p[1]+=Gt,h=e(p[0],p[1]))),h!==o)f=0,h?(n.lineStart(),v=i(p,t),n.point(v[0],v[1])):(v=i(t,p),n.point(v[0],v[1]),n.lineEnd()),t=v;else if(l&&t&&c^h){var y;d&r||!(y=i(p,t,!0))||(f=0,c?(n.lineStart(),n.point(y[0][0],y[0][1]),n.point(y[1][0],y[1][1]),n.lineEnd()):(n.point(y[1][0],y[1][1]),n.lineEnd(),n.lineStart(),n.point(y[0][0],y[0][1])))}!h||t&&Rr(t,p)||n.point(p[0],p[1]),t=p,o=h,r=d},lineEnd:function(){o&&n.lineEnd(),t=null},clean:function(){return f|(a&&o)<<1}}}function i(n,t,r){var e=d(n),o=d(t),i=[1,0,0],u=m(e,o),c=y(u,u),l=u[0],f=c-l*l;if(!f)return!r&&n;var s=a*c/f,g=-a*l/f,v=m(i,u),p=E(i,s),M=E(u,g);w(p,M);var _=v,S=y(p,_),P=y(_,_),x=S*S-P*(y(p,p)-1);if(!(x<0)){var b=Zt(x),j=E(_,(-S-b)/P);if(w(j,p),j=h(j),!r)return j;var R,A=n[0],k=t[0],N=n[1],C=t[1];k<A&&(R=A,A=k,k=R);var G=k-A,q=Ht(G-Lt)<Gt,L=q||G<Gt;if(!q&&C<N&&(R=N,N=C,C=R),L?q?N+C>0^j[1]<(Ht(j[0]-A)<Gt?N:C):N<=j[1]&&j[1]<=C:G>Lt^(A<=j[0]&&j[0]<=k)){var z=E(_,(-S+b)/P);return w(z,p),[j,h(z)]}}}function u(t,r){var e=c?n:Lt-n,o=0;return t<-e?o|=1:t>e&&(o|=2),r<-e?o|=4:r>e&&(o|=8),o}var a=Ot(n),c=a>0,l=Ht(a)>Gt;return ce(e,o,r,c?[0,-n]:[-Lt,n-Lt])},se=function(n){return{stream:An(n)}};kn.prototype={constructor:kn,point:function(n,t){this.stream.point(n,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var ge=16,ve=Ot(30*Bt),pe=function(n,t){return+t?qn(n,t):Gn(n)},he=An({point:function(n,t){this.stream.point(n*Bt,t*Bt)}}),de=function(){return Fn(In).scale(155.424).center([0,33.6442])},ye=function(){return de().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])},me=function(){function n(n){var t=n[0],r=n[1];return a=null,o.point(t,r),a||(i.point(t,r),a)||(u.point(t,r),a)}function t(){return r=e=null,n}var r,e,o,i,u,a,c=ye(),l=de().rotate([154,0]).center([-2,58.5]).parallels([55,65]),f=de().rotate([157,0]).center([-3,19.9]).parallels([8,18]),s={point:function(n,t){a=[n,t]}};return n.invert=function(n){var t=c.scale(),r=c.translate(),e=(n[0]-r[0])/t,o=(n[1]-r[1])/t;return(o>=.12&&o<.234&&e>=-.425&&e<-.214?l:o>=.166&&o<.234&&e>=-.214&&e<-.115?f:c).invert(n)},n.stream=function(n){return r&&e===n?r:r=Bn([c.stream(e=n),l.stream(n),f.stream(n)])},n.precision=function(n){return arguments.length?(c.precision(n),l.precision(n),f.precision(n),t()):c.precision()},n.scale=function(t){return arguments.length?(c.scale(t),l.scale(.35*t),f.scale(t),n.translate(c.translate())):c.scale()},n.translate=function(n){if(!arguments.length)return c.translate();var r=c.scale(),e=+n[0],a=+n[1];return o=c.translate(n).clipExtent([[e-.455*r,a-.238*r],[e+.455*r,a+.238*r]]).stream(s),i=l.translate([e-.307*r,a+.201*r]).clipExtent([[e-.425*r+Gt,a+.12*r+Gt],[e-.214*r-Gt,a+.234*r-Gt]]).stream(s),u=f.translate([e-.205*r,a+.212*r]).clipExtent([[e-.214*r+Gt,a+.166*r+Gt],[e-.115*r-Gt,a+.234*r-Gt]]).stream(s),t()},n.fitExtent=function(t,r){return Nn(n,t,r)},n.fitSize=function(t,r){return Cn(n,t,r)},n.scale(1070)},we=Hn(function(n){return Zt(2/(1+n))});we.invert=Dn(function(n){return 2*i(n/2)});var Ee=function(){return Ln(we).scale(124.75).clipAngle(179.999)},Me=Hn(function(n){return(n=o(n))&&n/Kt(n)});Me.invert=Dn(function(n){return n});var _e=function(){return Ln(Me).scale(79.4188).clipAngle(179.999)};Wn.invert=function(n,t){return[n,2*Dt(Vt(t))-zt]};var Se=function(){return On(Wn).scale(961/Tt)},Pe=function(){return Fn(Vn).scale(109.5).parallels([30,30])};Un.invert=Un;var xe=function(){return Ln(Un).scale(152.63)},be=function(){return Fn(Yn).scale(131.154).center([0,13.9389])};Kn.invert=Dn(Dt);var je=function(){return Ln(Kn).scale(144.049).clipAngle(60)},Re=function(){function n(){return o=i=null,u}var t,r,e,o,i,u,a=1,c=0,l=0,f=1,s=1,g=Br,v=null,p=Br;return u={stream:function(n){return o&&i===n?o:o=g(p(i=n))},clipExtent:function(o){return arguments.length?(p=null==o?(v=t=r=e=null,Br):Z(v=+o[0][0],t=+o[0][1],r=+o[1][0],e=+o[1][1]),n()):null==v?null:[[v,t],[r,e]]},scale:function(t){return arguments.length?(g=Xn((a=+t)*f,a*s,c,l),n()):a},translate:function(t){return arguments.length?(g=Xn(a*f,a*s,c=+t[0],l=+t[1]),n()):[c,l]},reflectX:function(t){return arguments.length?(g=Xn(a*(f=t?-1:1),a*s,c,l),n()):f<0},reflectY:function(t){return arguments.length?(g=Xn(a*f,a*(s=t?-1:1),c,l),n()):s<0},fitExtent:function(n,t){return Nn(u,n,t)},fitSize:function(n,t){return Cn(u,n,t)}}};Zn.invert=Dn(i);var Ae=function(){return Ln(Zn).scale(249.5).clipAngle(90+Gt)};$n.invert=Dn(function(n){return 2*Dt(n)});var ke=function(){return Ln($n).scale(250).clipAngle(142)};Jn.invert=function(n,t){return[-t,2*Dt(Vt(n))-zt]};var Ne=function(){var n=On(Jn),t=n.center,r=n.rotate;return n.center=function(n){return arguments.length?t([-n[1],n[0]]):(n=t(),[n[1],-n[0]])},n.rotate=function(n){return arguments.length?r([n[0],n[1],n.length>2?n[2]+90:90]):(n=r(),[n[0],n[1],n[2]-90])},r([0,0,90]).scale(159.155)};n.geoArea=ir,n.geoBounds=cr,n.geoCentroid=fr,n.geoCircle=xr,n.geoClipExtent=Cr,n.geoDistance=Tr,n.geoGraticule=on,n.geoGraticule10=un,n.geoInterpolate=Ir,n.geoLength=Lr,n.geoPath=ie,n.geoAlbers=ye,n.geoAlbersUsa=me,n.geoAzimuthalEqualArea=Ee,n.geoAzimuthalEqualAreaRaw=we,n.geoAzimuthalEquidistant=_e,n.geoAzimuthalEquidistantRaw=Me,n.geoConicConformal=Pe,n.geoConicConformalRaw=Vn,n.geoConicEqualArea=de,n.geoConicEqualAreaRaw=In,n.geoConicEquidistant=be,n.geoConicEquidistantRaw=Yn,n.geoEquirectangular=xe,n.geoEquirectangularRaw=Un,n.geoGnomonic=je,n.geoGnomonicRaw=Kn,n.geoIdentity=Re,n.geoProjection=Ln,n.geoProjectionMutator=zn,n.geoMercator=Se,n.geoMercatorRaw=Wn,n.geoOrthographic=Ae,n.geoOrthographicRaw=Zn,n.geoStereographic=ke,n.geoStereographicRaw=$n,n.geoTransverseMercator=Ne,n.geoTransverseMercatorRaw=Jn,n.geoRotation=Pr,n.geoStream=tr,n.geoTransform=se,Object.defineProperty(n,"__esModule",{value:!0})}),!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("d3-geo"),require("d3-array")):"function"==typeof define&&define.amd?define("d3-geo-projection",["exports","d3-geo","d3-array"],t):t(n.d3=n.d3||{},n.d3,n.d3)}(this,function(n,t,r){"use strict";function e(n){return n?n/Math.sin(n):1}function o(n){return n>1?Xt:n<-1?-Xt:Math.asin(n)}function i(n){return n>1?0:n<-1?Kt:Math.acos(n)}function u(n){return n>0?Math.sqrt(n):0}function a(n){return n=Ft(2*n),(n-1)/(n+1)}function c(n){return(Ft(n)-Ft(-n))/2}function l(n){return(Ft(n)+Ft(-n))/2}function f(n){return It(n+u(n*n+1))}function s(n){return It(n+u(n*n-1))}function g(n){function t(n,t){var r=zt(n),o=zt(t),i=Qt(t),u=o*r,a=-((1-u?It((1+u)/2)/(1-u):-.5)+e/(1+u));return[a*o*Qt(n),a*i]}var r=Vt(n/2),e=2*It(zt(n/2))/(r*r);return t.invert=function(t,r){var i,a=u(t*t+r*r),c=-n/2,l=50;if(!a)return[0,0];do{var f=c/2,s=zt(f),g=Qt(f),v=Vt(f),p=It(1/s);c-=i=(2/v*p-e*v-a)/(-p/(g*g)+1-e/(2*s*s))}while(Gt(i)>Ut&&--l>0);var h=Qt(c);return[Lt(t*h,a*zt(c)),o(r*h/a)]},t}function v(n,t){var r=zt(t),o=e(i(r*zt(n/=2)));return[2*r*Qt(n)*o,Qt(t)*o]}function p(n){function t(n,t){var a=zt(t),c=zt(n/=2);return[(1+a)*Qt(n),(o*t>-Lt(c,i)-.001?0:10*-o)+u+Qt(t)*e-(1+a)*r*c]}var r=Qt(n),e=zt(n),o=n>=0?1:-1,i=Vt(o*n),u=(1+r-e)/2;return t.invert=function(n,t){var a=0,c=0,l=50;do{var f=zt(a),s=Qt(a),g=zt(c),v=Qt(c),p=1+g,h=p*s-n,d=u+v*e-p*r*f-t,y=p*f/2,m=-s*v,w=r*p*s/2,E=e*g+r*f*v,M=m*w-E*y,_=(d*m-h*E)/M/2,S=(h*w-d*y)/M;a-=_,c-=S}while((Gt(_)>Ut||Gt(S)>Ut)&&--l>0);return o*c>-Lt(zt(a),i)-.001?[2*a,c]:null},t}function h(n,t){var r=Vt(t/2),e=u(1-r*r),o=1+e*zt(n/=2),i=Qt(n)*e/o,a=r/o,c=i*i,l=a*a;return[4/3*i*(3+c-3*l),4/3*a*(3+3*c-l)]}function d(n,t){var r=Gt(t);return r<Zt?[n,It(Vt(Zt+t/2))]:[n*zt(r)*(2*Jt-1/Qt(r)),Ot(t)*(2*Jt*(r-Zt)-It(Vt(r/2)))]}function y(n){function r(n,r){var i=t.geoAzimuthalEquidistantRaw(n,r);if(Gt(n)>Xt){var a=Lt(i[1],i[0]),c=u(i[0]*i[0]+i[1]*i[1]),l=e*Wt((a-Xt)/e)+Xt,f=Lt(Qt(a-=l),2-zt(a));a=l+o(Kt/c*Qt(f))-f,i[0]=c*zt(a),i[1]=c*Qt(a)}return i}var e=2*Kt/n;return r.invert=function(n,r){var o=u(n*n+r*r);if(o>Xt){var a=Lt(r,n),c=e*Wt((a-Xt)/e)+Xt,l=a>c?-1:1,f=o*zt(c-a),s=1/Vt(l*i((f-Kt)/u(Kt*(Kt-2*f)+o*o)));a=c+2*qt((s+l*u(s*s-3))/3),n=o*zt(a),r=o*Qt(a)}return t.geoAzimuthalEquidistantRaw.invert(n,r)},r}function m(n,t){var r,e=n*Qt(t),o=30;do t-=r=(t+Qt(t)-e)/(1+zt(t));while(Gt(r)>Ut&&--o>0);return t/2}function w(n,t,r){function e(e,o){return[n*e*zt(o=m(r,o)),t*Qt(o)]}return e.invert=function(e,i){return i=o(i/t),[e/(n*zt(i)),o((2*i+Qt(2*i))/r)]},e}function E(n,t){var r=m(Kt,t);return[pr*n/(1/zt(t)+hr/zt(r)),(t+Jt*Qt(r))/pr]}function M(n,t){return[n*zt(t),t]}function _(n){function t(t,e){var o=r+n-e,i=o?t*zt(e)/o:o;return[o*Qt(i),r-o*zt(i)]}if(!n)return M;var r=1/Vt(n);return t.invert=function(t,e){var o=u(t*t+(e=r-e)*e),i=r+n-o;return[o/zt(i)*Lt(t,e),i]},t}function S(n){function t(t,r){var e=Xt-r,o=e?t*n*Qt(e)/e:e;return[e*Qt(o)/n,Xt-e*zt(o)]}return t.invert=function(t,r){var e=t*n,o=Xt-r,i=u(e*e+o*o),a=Lt(e,o);return[(i?i/Qt(i):1)*a/n,Xt-i]},t}function P(n,t,r,e,a,c){var l,f=zt(c);if(Gt(n)>1||Gt(c)>1)l=i(r*a+t*e*f);else{var s=Qt(n/2),g=Qt(c/2);l=2*o(u(s*s+t*e*g*g))}return Gt(l)>Ut?[l,Lt(e*Qt(c),t*a-r*e*f)]:[0,0]}function x(n,t,r){return i((n*n+t*t-r*r)/(2*n*t))}function b(n){return n-2*Kt*Tt((n+Kt)/(2*Kt))}function j(n,t,r){function e(n,t){var r,e=Qt(t),o=zt(t),u=new Array(3);for(r=0;r<3;++r){var a=i[r];if(u[r]=P(t-a[1],a[3],a[2],o,e,n-a[0]),!u[r][0])return a.point;u[r][1]=b(u[r][1]-a.v[1])}var c=s.slice();for(r=0;r<3;++r){var g=2==r?0:r+1,v=x(i[r].v[0],u[r][0],u[g][0]);u[r][1]<0&&(v=-v),r?1==r?(v=l-v,c[0]-=u[r][0]*zt(v),c[1]-=u[r][0]*Qt(v)):(v=f-v,c[0]+=u[r][0]*zt(v),c[1]+=u[r][0]*Qt(v)):(c[0]+=u[r][0]*zt(v),c[1]-=u[r][0]*Qt(v))}return c[0]/=3,c[1]/=3,c}for(var o,i=[[n[0],n[1],Qt(n[1]),zt(n[1])],[t[0],t[1],Qt(t[1]),zt(t[1])],[r[0],r[1],Qt(r[1]),zt(r[1])]],u=i[2],a=0;a<3;++a,u=o)o=i[a],u.v=P(o[1]-u[1],u[3],u[2],o[3],o[2],o[0]-u[0]),u.point=[0,0];var c=x(i[0].v[0],i[2].v[0],i[1].v[0]),l=x(i[0].v[0],i[1].v[0],i[2].v[0]),f=Kt-c;i[2].point[1]=0,i[0].point[0]=-(i[1].point[0]=i[0].v[0]/2);var s=[i[2].point[0]=i[0].point[0]+i[2].v[0]*zt(c),2*(i[0].point[1]=i[1].point[1]=i[2].v[0]*Qt(c))];return e}function R(n){return n[0]*=er,n[1]*=er,n}function A(){return k([0,22],[45,22],[22.5,-22]).scale(380).center([22.5,2])}function k(n,r,e){var o=t.geoCentroid({type:"MultiPoint",coordinates:[n,r,e]}),i=[-o[0],-o[1]],u=t.geoRotation(i),a=t.geoProjection(j(R(u(n)),R(u(r)),R(u(e)))).rotate(i),c=a.center;return delete a.rotate,a.center=function(n){return arguments.length?c(u(n)):u.invert(c())},a.clipAngle(90)}function N(n,t){var r=u(1-Qt(t));return[2/nr*n*r,nr*(1-r)]}function C(n){function t(n,t){return[n,(n?n/Qt(n):1)*(Qt(t)*zt(n)-r*zt(t))]}var r=Vt(n);return t.invert=r?function(n,t){n&&(t*=Qt(n)/n);var e=zt(n);return[n,2*Lt(u(e*e+r*r-t*t)-e,r-t)]}:function(n,t){return[n,o(n?t*Vt(n)/n:t)]},t}function G(n,t){return[xr*n*(2*zt(2*t/3)-1)/nr,xr*nr*Qt(t/3)]}function q(n){function t(n,t){return[n*r,Qt(t)/r]}var r=zt(n);return t.invert=function(n,t){return[n/r,o(t*r)]},t}function L(n){function t(n,t){return[n*r,(1+r)*Vt(t/2)]}var r=zt(n);return t.invert=function(n,t){return[n/r,2*qt(t/(1+r))]},t}function z(n,t){var r=u(8/(3*Kt));return[r*n*(1-Gt(t)/Kt),r*t]}function F(n,t){var r=u(4-3*Qt(Gt(t)));return[2/u(6*Kt)*n*r,Ot(t)*u(2*Kt/3)*(2-r)]}function T(n,t){var r=u(Kt*(4+Kt));return[2/r*n*(1+u(1-4*t*t/(Kt*Kt))),4/r*t]}function I(n,t){var r=(2+Xt)*Qt(t);t/=2;for(var e=0,o=1/0;e<10&&Gt(o)>Ut;e++){var i=zt(t);t-=o=(t+Qt(t)*(i+2)-r)/(2*i*(1+i))}return[2/u(Kt*(4+Kt))*n*(1+zt(t)),2*u(Kt/(4+Kt))*Qt(t)]}function B(n,t){return[n*(1+zt(t))/u(2+Kt),2*t/u(2+Kt)]}function H(n,t){for(var r=(1+Xt)*Qt(t),e=0,o=1/0;e<10&&Gt(o)>Ut;e++)t-=o=(t+Qt(t)-r)/(1+zt(t));return r=u(2+Kt),[n*(1+zt(t))/r,2*t/r]}function D(n,t){var r=Qt(n/=2),e=zt(n),o=u(zt(t)),i=zt(t/=2),a=Qt(t)/(i+Jt*e*o),c=u(2/(1+a*a)),l=u((Jt*i+(e+r)*o)/(Jt*i+(e-r)*o));return[Lr*(c*(l-1/l)-2*It(l)),Lr*(c*a*(l+1/l)-2*qt(a))]}function W(n,t){var r=Vt(t/2);return[n*Fr*u(1-r*r),(1+Fr)*r]}function O(n,t){var r=t/2,e=zt(r);return[2*n/nr*zt(t)*e*e,nr*Vt(r)]}function Q(n){return[n[0]/2,o(Vt(n[1]/2*er))*rr]}function V(n){return[2*n[0],2*qt(Qt(n[1]*er))*rr]}function U(n,r){function e(r,e){var a=t.geoAzimuthalEquidistantRaw(r,e),c=a[0],l=a[1],f=c*c+l*l;if(f>i){var s=u(f),g=Lt(l,c),v=o*Wt(g/o),p=g-v,h=n*zt(p),d=(n*Qt(p)-p*Qt(h))/(Xt-h),y=Y(p,d),m=(Kt-n)/K(y,h,Kt);c=s;var w,E=50;do c-=w=(n+K(y,h,c)*m-s)/(y(c)*m);while(Gt(w)>Ut&&--E>0);l=p*Qt(c),c<Xt&&(l-=d*(c-Xt));var M=Qt(v),_=zt(v);a[0]=c*_-l*M,a[1]=c*M+l*_}return a}var o=2*Kt/r,i=n*n;return e.invert=function(r,e){var a=r*r+e*e;if(a>i){var c=u(a),l=Lt(e,r),f=o*Wt(l/o),s=l-f;r=c*zt(s),e=c*Qt(s);for(var g=r-Xt,v=Qt(r),p=e/v,h=r<Xt?1/0:0,d=10;;){var y=n*Qt(p),m=n*zt(p),w=Qt(m),E=Xt-m,M=(y-p*w)/E,_=Y(p,M);if(Gt(h)<Yt||!--d)break;p-=h=(p*v-M*g-e)/(v-2*g*(E*(m+p*y*zt(m)-w)-y*(y-p*w))/(E*E))}c=n+K(_,m,r)*(Kt-n)/K(_,m,Kt),l=f+p,r=c*zt(l),e=c*Qt(l)}return t.geoAzimuthalEquidistantRaw.invert(r,e)},e}function Y(n,t){return function(r){var e=n*zt(r);return r<Xt&&(e-=t),u(1+e*e)}}function K(n,t,r){for(var e=50,o=(r-t)/e,i=n(t)+n(r),u=1,a=t;u<e;++u)i+=2*n(a+=o);return.5*i*o}function X(n,t){var r=n*n,e=t*t;return[n*(1-.162388*e)*(.87-952426e-9*r*r),t*(1+e/12)]}function Z(n,t){var r=Ot(n),e=Ot(t),i=zt(t),u=zt(n)*i,a=Qt(n)*i,c=Qt(e*t);n=Gt(Lt(a,c)),t=o(u),Gt(n-Xt)>Ut&&(n%=Xt);var l=$(n>Kt/4?Xt-n:n,t);return n>Kt/4&&(c=l[0],l[0]=-l[1],l[1]=-c),l[0]*=r,l[1]*=-e,l}function $(n,t){if(t===Xt)return[0,0];var r,e,i=Qt(t),a=i*i,c=a*a,l=1+c,f=1+3*c,s=1-c,g=o(1/u(l)),v=s+a*l*g,p=(1-i)/v,h=u(p),d=p*l,y=u(d),m=h*s;if(0===n)return[0,-(m+a*y)];var w,E=zt(t),M=1/E,_=2*i*E,S=(-3*a+g*f)*_,P=(-v*E-(1-i)*S)/(v*v),x=.5*P/h,b=s*x-2*a*h*_,j=a*l*P+p*f*_,R=-M*_,A=-M*j,k=-2*M*b,N=4*n/Kt;if(n>.222*Kt||t<Kt/4&&n>.175*Kt){if(r=(m+a*u(d*(1+c)-m*m))/(1+c),n>Kt/4)return[r,r];var C=r,G=.5*r;r=.5*(G+C),e=50;do{var q=u(d-r*r),L=r*(k+R*q)+A*o(r/y)-N;if(!L)break;L<0?G=r:C=r,r=.5*(G+C)}while(Gt(C-G)>Ut&&--e>0)}else{r=Ut,e=25;do{var z=r*r,F=u(d-z),T=k+R*F,I=r*T+A*o(r/y)-N,B=T+(A-R*z)/F;r-=w=F?I/B:0}while(Gt(w)>Ut&&--e>0)}return[r,-m-a*u(d-r*r)]}function J(n,t){for(var r=0,e=1,i=.5,a=50;;){var c=i*i,l=u(i),f=o(1/u(1+c)),s=1-c+i*(1+c)*f,g=(1-l)/s,v=u(g),p=g*(1+c),h=v*(1-c),d=p-n*n,y=u(d),m=t+h+i*y;if(Gt(e-r)<Yt||0===--a||0===m)break;m>0?r=i:e=i,i=.5*(r+e)}if(!a)return null;var w=o(l),E=zt(w),M=1/E,_=2*l*E,S=(-3*i+f*(1+3*c))*_,P=(-s*E-(1-l)*S)/(s*s),x=.5*P/v,b=(1-c)*x-2*i*v*_,j=-2*M*b,R=-M*_,A=-M*(i*(1+c)*P+g*(1+3*c)*_);return[Kt/4*(n*(j+R*y)+A*o(n/u(p))),w]}function nn(n,t,r){var e,o,i;return n?(e=tn(n,r),t?(o=tn(t,1-r),i=o[1]*o[1]+r*e[0]*e[0]*o[0]*o[0],[[e[0]*o[2]/i,e[1]*e[2]*o[0]*o[1]/i],[e[1]*o[1]/i,-e[0]*e[2]*o[0]*o[2]/i],[e[2]*o[1]*o[2]/i,-r*e[0]*e[1]*o[0]/i]]):[[e[0],0],[e[1],0],[e[2],0]]):(o=tn(t,1-r),[[0,o[0]/o[1]],[1/o[1],0],[o[2]/o[1],0]])}function tn(n,t){var r,e,i,f,s;if(t<Ut)return f=Qt(n),e=zt(n),r=t*(n-f*e)/4,[f-r*e,e+r*f,1-t*f*f/2,n-r];if(t>=1-Ut)return r=(1-t)/4,e=l(n),f=a(n),i=1/e,s=e*c(n),[f+r*(s-n)/(e*e),i-r*f*i*(s-n),i+r*f*i*(s+n),2*qt(Ft(n))-Xt+r*(s-n)/e];var g=[1,0,0,0,0,0,0,0,0],v=[u(t),0,0,0,0,0,0,0,0],p=0;for(e=u(1-t),s=1;Gt(v[p]/g[p])>Ut&&p<8;)r=g[p++],v[p]=(r-e)/2,g[p]=(r+e)/2,e=u(r*e),s*=2;i=s*g[p]*n;do f=v[p]*Qt(e=i)/g[p],i=(o(f)+i)/2;while(--p);return[Qt(i),f=zt(i),f/zt(i-e),i]}function rn(n,t,r){var e=Gt(n),o=Gt(t),i=c(o);if(e){var a=1/Qt(e),l=1/(Vt(e)*Vt(e)),f=-(l+r*(i*i*a*a)-1+r),s=(r-1)*l,g=(-f+u(f*f-4*s))/2;return[en(qt(1/u(g)),r)*Ot(n),en(qt(u((g/l-1)/r)),1-r)*Ot(t)]}return[0,en(qt(i),1-r)*Ot(t)]}function en(n,t){if(!t)return n;if(1===t)return It(Vt(n/2+Zt));for(var r=1,e=u(1-t),o=u(t),i=0;Gt(o)>Ut;i++){if(n%Kt){var a=qt(e*Vt(n)/r);a<0&&(a+=Kt),n+=a+~~(n/Kt)*Kt}else n+=n;o=(r+e)/2,e=u(r*e),o=((r=o)-e)/2}return n/(Dt(2,i)*r)}function on(n,t){var r=(Jt-1)/(Jt+1),e=u(1-r*r),o=en(Xt,e*e),i=-1,a=It(Vt(Kt/4+Gt(t)/2)),c=Ft(i*a)/u(r),l=un(c*zt(i*n),c*Qt(i*n)),f=rn(l[0],l[1],e*e);return[-f[1],(t>=0?1:-1)*(.5*o-f[0])]}function un(n,t){var r=n*n,e=t+1,o=1-r-t*t;return[.5*((n>=0?Xt:-Xt)-Lt(o,2*n)),-.25*It(o*o+4*r)+.5*It(e*e+r)]}function an(n,t){var r=t[0]*t[0]+t[1]*t[1];return[(n[0]*t[0]+n[1]*t[1])/r,(n[1]*t[0]-n[0]*t[1])/r]}function cn(n,r){function e(e,o){var i=t.geoAzimuthalEqualAreaRaw(e/r,o);return i[0]*=n,i}return arguments.length<2&&(r=n),1===r?t.geoAzimuthalEqualAreaRaw:r===1/0?ln:(e.invert=function(e,o){var i=t.geoAzimuthalEqualAreaRaw.invert(e/n,o);return i[0]*=r,i},e)}function ln(n,t){return[n*zt(t)/zt(t/=2),2*Qt(t)]}function fn(n){function t(n,t){var u=o(n,t);n=u[0],t=u[1];var a=Qt(t),c=zt(t),l=zt(n),f=i(r*a+e*c*l),s=Qt(f),g=Gt(s)>Ut?f/s:1;return[g*e*Qt(n),(Gt(n)>Xt?g:-g)*(r*c-e*a*l)]}var r=Qt(n),e=zt(n),o=sn(n);return o.invert=sn(-n),t.invert=function(n,t){var e=u(n*n+t*t),i=-Qt(e),a=zt(e),c=e*a,l=-t*i,f=e*r,s=u(c*c+l*l-f*f),g=Lt(c*f+l*s,l*f-c*s),v=(e>Xt?-1:1)*Lt(n*i,e*zt(g)*a+t*Qt(g)*i);return o.invert(v,g)},t}function sn(n){var t=Qt(n),r=zt(n);return function(n,e){var i=zt(e),u=zt(n)*i,a=Qt(n)*i,c=Qt(e);return[Lt(a,u*r-c*t),o(c*r+u*t)]}}function gn(n){function t(t,f){var s,g=Gt(f);if(g>r){var v=Ht(n-1,Bt(0,Tt((t+Kt)/a)));t+=Kt*(n-1)/n-v*a,s=N(t,g),s[0]=s[0]*tr/e-tr*(n-1)/(2*n)+v*tr/n,s[1]=o+4*(s[1]-i)*u/tr,f<0&&(s[1]=-s[1])}else s=oe(t,f);return s[0]*=c,s[1]/=l,s}var r=ee*er,e=N(Kt,r)[0]-N(-Kt,r)[0],o=oe(0,r)[1],i=N(0,r)[1],u=nr-i,a=tr/n,c=4/tr,l=o+u*u*4/tr;return t.invert=function(t,r){t/=c,r*=l;var f=Gt(r);if(f>o){var s=Ht(n-1,Bt(0,Tt((t+Kt)/a)));t=(t+Kt*(n-1)/n-s*a)*e/tr;var g=N.invert(t,.25*(f-o)*tr/u+i);return g[0]-=Kt*(n-1)/n-s*a,r<0&&(g[1]=-g[1]),g}return oe.invert(t,r)},t}function vn(n){return{type:"Polygon",coordinates:[r.range(-180,180+n/2,n).map(function(n,t){return[n,1&t?90-1e-6:ee]}).concat(r.range(180,-180-n/2,-n).map(function(n,t){return[n,1&t?-90+1e-6:-ee]}))]}}function pn(n){function t(t,o){var i,a,v=1-Qt(o);if(v&&v<2){var p,h=Xt-o,d=25;do{var y=Qt(h),m=zt(h),w=c+Lt(y,e-m),E=1+g-2*e*m;h-=p=(h-s*c-e*y+E*w-.5*v*r)/(2*e*y*w)}while(Gt(p)>Yt&&--d>0);i=l*u(E),a=t*w/Kt}else i=l*(n+v),a=t*c/Kt;return[i*Qt(a),f-i*zt(a)]}var r,e=1+n,a=Qt(1/e),c=o(a),l=2*u(Kt/(r=Kt+4*c*e)),f=.5*l*(e+u(n*(2+n))),s=n*n,g=e*e;return t.invert=function(n,t){var a=n*n+(t-=f)*t,v=(1+g-a/(l*l))/(2*e),p=i(v),h=Qt(p),d=c+Lt(h,e-v);return[o(n/u(a))*Kt/d,o(1-2*(p-s*c-e*h+(1+g-2*e*v)*d)/r)]},t}function hn(n,t){return t>-ae?(n=gr(n,t),n[1]+=ce,n):M(n,t)}function dn(n,t){return Gt(t)>ae?(n=gr(n,t),n[1]-=t>0?ce:-ce,n):M(n,t)}function yn(n,t){return Gt(n[0]-t[0])<Ut&&Gt(n[1]-t[1])<Ut}function mn(n,t){for(var r,e,o,i=-1,u=n.length,a=n[0],c=[];++i<u;){r=n[i],e=(r[0]-a[0])/t,o=(r[1]-a[1])/t;for(var l=0;l<t;++l)c.push([a[0]+l*e,a[1]+l*o]);a=r}return c.push(r),c}function wn(n){var t,e,o,i,u,a,c,l=[],f=n[0].length;for(c=0;c<f;++c)t=n[0][c],e=t[0][0],o=t[0][1],i=t[1][1],u=t[2][0],a=t[2][1],l.push(mn([[e+Ut,o+Ut],[e+Ut,i-Ut],[u-Ut,i-Ut],[u-Ut,a+Ut]],30));for(c=n[1].length-1;c>=0;--c)t=n[1][c],e=t[0][0],o=t[0][1],i=t[1][1],u=t[2][0],a=t[2][1],l.push(mn([[u-Ut,a-Ut],[u-Ut,i+Ut],[e+Ut,i+Ut],[e+Ut,o-Ut]],30));return{type:"Polygon",coordinates:[r.merge(l)]}}function En(n,t){return[3/tr*n*u(Kt*Kt/3-t*t),t]}function Mn(n){function t(t,r){if(Gt(Gt(r)-Xt)<Ut)return[0,r<0?-2:2];var e=Qt(r),o=Dt((1+e)/(1-e),n/2),i=.5*(o+1/o)+zt(t*=n);return[2*Qt(t)/i,(o-1/o)/i]}return t.invert=function(t,r){var e=Gt(r);if(Gt(e-2)<Ut)return t?null:[0,Ot(r)*Xt];if(e>2)return null;t/=2,r/=2;var i=t*t,u=r*r,a=2*r/(1+i+u);return a=Dt((1+a)/(1-a),1/n),[Lt(2*t,1-i-u)/n,o((a-1)/(a+1))]},t}function _n(n,t){return[n*(1+u(zt(t)))/2,t/(zt(t/2)*zt(n/6))]}function Sn(n,t){var r=n*n,e=t*t;return[n*(.975534+e*(-.119161+r*-.0143059+e*-.0547009)),t*(1.00384+r*(.0802894+e*-.02855+199025e-9*r)+e*(.0998909+e*-.0491032))]}function Pn(n,t){return[Qt(n)/zt(t),Vt(t)*zt(n)]}function xn(n){function t(t,o){var i=o-n,u=Gt(i)<Ut?t*r:Gt(u=Zt+o/2)<Ut||Gt(Gt(u)-Xt)<Ut?0:t*i/It(Vt(u)/e);return[u,i]}var r=zt(n),e=Vt(Zt+n/2);return t.invert=function(t,o){var i,u=o+n;return[Gt(o)<Ut?t/r:Gt(i=Zt+u/2)<Ut||Gt(Gt(i)-Xt)<Ut?0:t*It(Vt(i)/e)/o,u]},t}function bn(n,t){return[n,1.25*It(Vt(Zt+.4*t))]}function jn(n){function t(t,e){for(var o,i=zt(e),u=2/(1+i*zt(t)),a=u*i*Qt(t),c=u*Qt(e),l=r,f=n[l],s=f[0],g=f[1];--l>=0;)f=n[l],s=f[0]+a*(o=s)-c*g,g=f[1]+a*g+c*o;return s=a*(o=s)-c*g,g=a*g+c*o,[s,g]}var r=n.length-1;return t.invert=function(t,e){var i=20,a=t,c=e;do{for(var l,f=r,s=n[f],g=s[0],v=s[1],p=0,h=0;--f>=0;)s=n[f],p=g+a*(l=p)-c*h,h=v+a*h+c*l,g=s[0]+a*(l=g)-c*v,v=s[1]+a*v+c*l;p=g+a*(l=p)-c*h,h=v+a*h+c*l,g=a*(l=g)-c*v-t,v=a*v+c*l-e;var d,y,m=p*p+h*h;a-=d=(g*p+v*h)/m,c-=y=(v*p-g*h)/m}while(Gt(d)+Gt(y)>Ut*Ut&&--i>0);if(i){var w=u(a*a+c*c),E=2*qt(.5*w),M=Qt(E);return[Lt(a*M,w*zt(E)),w?o(c*M/w):0]}},t}function Rn(){return Gn(Ce,[152,-64]).scale(1500).center([-160.908,62.4864]).clipAngle(25)}function An(){return Gn(Ge,[95,-38]).scale(1e3).clipAngle(55).center([-96.5563,38.8675])}function kn(){return Gn(qe,[120,-45]).scale(359.513).clipAngle(55).center([-117.474,53.0628])}function Nn(){return Gn(Le,[-20,-18]).scale(209.091).center([20,16.7214]).clipAngle(82)}function Cn(){return Gn(ze,[165,10]).scale(250).clipAngle(130).center([-165,-10])}function Gn(n,r){var e=t.geoProjection(jn(n)).rotate(r).clipAngle(90),o=t.geoRotation(r),i=e.center;return delete e.rotate,e.center=function(n){return arguments.length?i(o(n)):o.invert(i())},e}function qn(n,t){var r=o(7*Qt(t)/(3*Fe));return[Fe*n*(2*zt(2*r/3)-1)/Te,9*Qt(r/3)/Te]}function Ln(n,t){for(var r,e=(1+$t)*Qt(t),o=t,i=0;i<25&&(o-=r=(Qt(o/2)+Qt(o)-e)/(.5*zt(o/2)+zt(o)),!(Gt(r)<Ut));i++);return[n*(1+2*zt(o)/zt(o/2))/(3*Jt),2*u(3)*Qt(o/2)/u(2+Jt)]}function zn(n,t){for(var r,e=u(6/(4+Kt)),o=(1+Kt/4)*Qt(t),i=t/2,a=0;a<25&&(i-=r=(i/2+Qt(i)-o)/(.5+zt(i)),!(Gt(r)<Ut));a++);return[e*(.5+zt(i))*n/1.5,e*i]}function Fn(n,t){var r=t*t,e=r*r;return[n*(.8707-.131979*r+e*(-.013791+e*(.003971*r-.001529*e))),t*(1.007226+r*(.015085+e*(-.044475+.028874*r-.005916*e)))]}function Tn(n,t){return[n*(1+zt(t))/2,2*(t-Vt(t/2))]}function In(n,t){var r=t*t;return[n,t*(Oe+r*r*(Qe+r*(Ve+Ue*r)))]}function Bn(n,t){if(Gt(t)<Ut)return[n,0];var r=Vt(t),e=n*Qt(t);return[Qt(e)/r,t+(1-zt(e))/r]}function Hn(n){var t=1/(n[0]*n[4]-n[1]*n[3]);return[t*n[4],-t*n[1],t*(n[1]*n[5]-n[2]*n[4]),-t*n[3],t*n[0],t*(n[2]*n[3]-n[0]*n[5])]}function Dn(n,t){return[n[0]*t[0]+n[1]*t[3],n[0]*t[1]+n[1]*t[4],n[0]*t[2]+n[1]*t[5]+n[2],n[3]*t[0]+n[4]*t[3],n[3]*t[1]+n[4]*t[4],n[3]*t[2]+n[4]*t[5]+n[5]]}function Wn(n,t){return[n[0]-t[0],n[1]-t[1]]}function On(n){return u(n[0]*n[0]+n[1]*n[1])}function Qn(n,t){return Lt(n[0]*t[1]-n[1]*t[0],n[0]*t[0]+n[1]*t[1])}function Vn(n,r,e){var o,i,u=r.edges,a=u.length,c={type:"MultiPoint",coordinates:r.face},l=r.face.filter(function(n){return 90!==Gt(n[1])}),f=t.geoBounds({type:"MultiPoint",coordinates:l}),s=!1,g=-1,v=f[1][0]-f[0][0],p=180===v||360===v?[(f[0][0]+f[1][0])/2,(f[0][1]+f[1][1])/2]:t.geoCentroid(c);if(e)for(;++g<a&&u[g]!==e;);++g;for(var h=0;h<a;++h)i=u[(h+g)%a],Array.isArray(i)?(s||(n.point((o=t.geoInterpolate(i[0],p)(Ut))[0],o[1]),s=!0),n.point((o=t.geoInterpolate(i[1],p)(Ut))[0],o[1])):(s=!1,i!==e&&Vn(n,i,r))}function Un(n,t){return n&&t&&n[0]===t[0]&&n[1]===t[1]}function Yn(n,t){for(var r,e,o=n.length,i=null,u=0;u<o;++u){r=n[u];for(var a=t.length;--a>=0;)if(e=t[a],r[0]===e[0]&&r[1]===e[1]){if(i)return[i,r];i=r}}}function Kn(n){for(var t=n.length,r=[],e=n[t-1],o=0;o<t;++o)r.push([e,e=n[o]]);return r}function Xn(n){return n.project.invert||n.children&&n.children.some(Xn)}function Zn(n,t){var r=N(n,t);return[r[0]*uo,r[1]]}function $n(n,t){for(var r=0,e=n.length,o=0;r<e;++r)o+=n[r]*t[r];
return o}function Jn(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]]}function nt(n){return[Lt(n[1],n[0])*rr,o(Bt(-1,Ht(1,n[2])))*rr]}function tt(n){var t=n[0]*er,r=n[1]*er,e=zt(r);return[e*zt(t),e*Qt(t),Qt(r)]}function rt(n,t){return{type:"FeatureCollection",features:n.features.map(function(n){return et(n,t)})}}function et(n,t){return{type:"Feature",id:n.id,properties:n.properties,geometry:it(n.geometry,t)}}function ot(n,t){return{type:"GeometryCollection",geometries:n.geometries.map(function(n){return it(n,t)})}}function it(n,r){if(!n)return null;if("GeometryCollection"===n.type)return ot(n,r);var e;switch(n.type){case"Point":e=ho;break;case"MultiPoint":e=ho;break;case"LineString":e=yo;break;case"MultiLineString":e=yo;break;case"Polygon":e=mo;break;case"MultiPolygon":e=mo;break;case"Sphere":e=mo;break;default:return null}return t.geoStream(n,r(e)),e.result()}function ut(n){function t(t,e){var o=r?Vt(t*r/2)/r:t/2;if(!e)return[2*o,-n];var i=2*qt(o*Qt(e)),u=1/Vt(e);return[Qt(i)*u,e+(1-zt(i))*u-n]}var r=Qt(n);return t.invert=function(t,e){if(Gt(e+=n)<Ut)return[r?2*qt(r*t/2)/r:t,0];var u,a=t*t+e*e,c=0,l=10;do{var f=Vt(c),s=1/zt(c),g=a-2*e*c+c*c;c-=u=(f*g+2*(c-e))/(2+g*s*s+2*(c-e)*f)}while(Gt(u)>Ut&&--l>0);var v=t*(f=Vt(c)),p=Vt(Gt(e)<Gt(c+1/f)?.5*o(v):.5*i(v)+Kt/4)/Qt(c);return[r?2*qt(r*p)/r:2*p,c]},t}function at(n,t){var r,e=Ht(18,36*Gt(t)/Kt),o=Tt(e),i=e-o,u=(r=Po[o])[0],a=r[1],c=(r=Po[++o])[0],l=r[1],f=(r=Po[Ht(19,++o)])[0],s=r[1];return[n*(c+i*(f-u)/2+i*i*(f-2*c+u)/2),(t>0?Xt:-Xt)*(l+i*(s-a)/2+i*i*(s-2*l+a)/2)]}function ct(n){function t(t,r){var e=zt(r),o=(n-1)/(n-e*zt(t));return[o*e*Qt(t),o*Qt(r)]}return t.invert=function(t,r){var e=t*t+r*r,i=u(e),a=(n-u(1-e*(n+1)/(n-1)))/((n-1)/i+i/(n-1));return[Lt(t*a,i*u(1-a*a)),i?o(r*a/i):0]},t}function lt(n,t){function r(t,r){var u=e(t,r),a=u[1],c=a*i/(n-1)+o;return[u[0]*o/c,a/c]}var e=ct(n);if(!t)return e;var o=zt(t),i=Qt(t);return r.invert=function(t,r){var u=(n-1)/(n-1-r*i);return e.invert(u*t,u*r*o)},r}function ft(n){return Math.floor(n*Ro)/Ro}function st(n){return n===Go||n===Lo?[0,n]:[Ao,ft(n)]}function gt(n){n[0]<=ko?n[0]=Ao:n[0]>=Co&&(n[0]=No),n[1]<=qo?n[1]=Go:n[1]>=zo&&(n[1]=Lo)}function vt(n){n.forEach(gt)}function pt(n,t){for(var r=0,e=n.length;r<e;++r){var o=n[r];o.polygon=n,t.push(o);for(var i=0,u=o.length;i<u;++i){var a=o[i],c=a[0],l=a[1];if(c<=ko||c>=Co||l<=qo||l>=zo){gt(a);for(var f=i+1;f<u;++f){var s=o[f],g=s[0],v=s[1];if(g>ko&&g<Co&&v>qo&&v<zo)break}if(f===i+1)continue;if(i){var p=o.slice(0,i+1);p.polygon=n,p[p.length-1]=st(l),t[t.length-1]=p}else t.pop();if(f>=u)break;t.push(o=o.slice(f-1)),o[0]=st(o[0][1]),o.polygon=n,i=-1,u=o.length}}}n.length=0}function ht(n){var t,r,e,o,i,u,a=n.length,c={},l={};for(t=0;t<a;++t)r=n[t],e=r[0],i=r[r.length-1],e[0]!==i[0]||e[1]!==i[1]?(r.index=t,c[e]=l[i]=r):(r.polygon.push(r),n[t]=null);for(t=0;t<a;++t)if(r=n[t]){if(e=r[0],i=r[r.length-1],o=l[e],u=c[i],delete c[e],delete l[i],e[0]===i[0]&&e[1]===i[1]){r.polygon.push(r);continue}o?(delete l[e],delete c[o[0]],o.pop(),n[o.index]=null,r=o.concat(r),r.polygon=o.polygon,o===u?r.polygon.push(r):(r.index=a++,n.push(c[r[0]]=l[r[r.length-1]]=r))):u?(delete c[i],delete l[u[u.length-1]],r.pop(),r=r.concat(u),r.polygon=u.polygon,r.index=a++,n[u.index]=null,n.push(c[r[0]]=l[r[r.length-1]]=r)):(r.push(r[0]),r.polygon.push(r))}}function dt(n){yt(n.geometry)}function yt(n){if(n){var t,r,e;switch(n.type){case"GeometryCollection":return void n.geometries.forEach(yt);case"Point":gt(n.coordinates);break;case"MultiPoint":case"LineString":vt(n.coordinates);break;case"MultiLineString":n.coordinates.forEach(vt);break;case"Polygon":pt(n.coordinates,t=[]);break;case"MultiPolygon":for(t=[],r=-1,e=n.coordinates.length;++r<e;)pt(n.coordinates[r],t);break;default:return}ht(t)}}function mt(n,t){var r=Vt(t/2),e=Qt(Zt*r);return[n*(.74482-.34588*e*e),1.70711*r]}function wt(n){function r(n,r){var o=t.geoGnomonicRaw(n,r);return o[0]*=e,o}var e=zt(n);return r.invert=function(n,r){return t.geoGnomonicRaw.invert(n/e,r)},r}function Et(){return Mt([-158,21.5],[-77,39]).clipAngle(60).scale(400)}function Mt(n,t){return Io(wt,n,t)}function _t(n){function r(t,r){var c=i(zt(r)*zt(t-e)),l=i(zt(r)*zt(t-o)),f=r<0?-1:1;return c*=c,l*=l,[(c-l)/(2*n),f*u(4*a*l-(a-c+l)*(a-c+l))/(2*n)]}if(!(n*=2))return t.geoAzimuthalEquidistantRaw;var e=-n/2,o=-e,a=n*n,c=Vt(o),l=.5/Qt(o);return r.invert=function(n,t){var r,a,f=t*t,s=zt(u(f+(r=n+e)*r)),g=zt(u(f+(r=n+o)*r));return[Lt(a=s-g,r=(s+g)*c),(t<0?-1:1)*i(u(r*r+a*a)*l)]},r}function St(){return Pt([-158,21.5],[-77,39]).clipAngle(130).scale(122.571)}function Pt(n,t){return Io(_t,n,t)}function xt(n,t){if(Gt(t)<Ut)return[n,0];var r=Gt(t/Xt),e=o(r);if(Gt(n)<Ut||Gt(Gt(t)-Xt)<Ut)return[0,Ot(t)*Kt*Vt(e/2)];var i=zt(e),a=Gt(Kt/n-n/Kt)/2,c=a*a,l=i/(r+i-1),f=l*(2/r-1),s=f*f,g=s+c,v=l-s,p=c+l;return[Ot(n)*Kt*(a*v+u(c*v*v-g*(l*l-s)))/g,Ot(t)*Kt*(f*p-a*u((c+1)*g-p*p))/g]}function bt(n,t){if(Gt(t)<Ut)return[n,0];var r=Gt(t/Xt),e=o(r);if(Gt(n)<Ut||Gt(Gt(t)-Xt)<Ut)return[0,Ot(t)*Kt*Vt(e/2)];var i=zt(e),a=Gt(Kt/n-n/Kt)/2,c=a*a,l=i*(u(1+c)-a*i)/(1+c*r*r);return[Ot(n)*Kt*l,Ot(t)*Kt*u(1-l*(2*a+l))]}function jt(n,t){if(Gt(t)<Ut)return[n,0];var r=t/Xt,e=o(r);if(Gt(n)<Ut||Gt(Gt(t)-Xt)<Ut)return[0,Kt*Vt(e/2)];var i=(Kt/n-n/Kt)/2,a=r/(1+zt(e));return[Kt*(Ot(n)*u(i*i+1-a*a)-i),Kt*a]}function Rt(n,t){if(!t)return[n,0];var r=Gt(t);if(!n||r===Xt)return[0,t];var e=r/Xt,o=e*e,i=(8*e-o*(o+2)-5)/(2*o*(e-1)),a=i*i,c=e*i,l=o+a+2*c,f=e+3*i,s=n/Xt,g=s+1/s,v=Ot(Gt(n)-Xt)*u(g*g-4),p=v*v,h=l*(o+a*p-1)+(1-o)*(o*(f*f+4*a)+12*c*a+4*a*a),d=(v*(l+a-1)+2*u(h))/(4*l+p);return[Ot(n)*Xt*d,Ot(t)*Xt*u(1+v*Gt(d)-d*d)]}function At(n,t){return[n*u(1-3*t*t/(Kt*Kt)),t]}function kt(n,t){var r=.90631*Qt(t),e=u(1-r*r),o=u(2/(1+e*zt(n/=3)));return[2.66723*e*o*Qt(n),1.24104*r*o]}function Nt(n,t){var r=zt(t),e=zt(n)*r,o=1-e,i=zt(n=Lt(Qt(n)*r,-Qt(t))),a=Qt(n);return r=u(1-e*e),[a*r-i*o,-i*r-a*o]}function Ct(n,t){var r=v(n,t);return[(r[0]+n/Xt)/2,(r[1]+t)/2]}var Gt=Math.abs,qt=Math.atan,Lt=Math.atan2,zt=Math.cos,Ft=Math.exp,Tt=Math.floor,It=Math.log,Bt=Math.max,Ht=Math.min,Dt=Math.pow,Wt=Math.round,Ot=Math.sign||function(n){return n>0?1:n<0?-1:0},Qt=Math.sin,Vt=Math.tan,Ut=1e-6,Yt=1e-12,Kt=Math.PI,Xt=Kt/2,Zt=Kt/4,$t=Math.SQRT1_2,Jt=u(2),nr=u(Kt),tr=2*Kt,rr=180/Kt,er=Kt/180,or=function(){var n=Xt,r=t.geoProjectionMutator(g),e=r(n);return e.radius=function(t){return arguments.length?r(n=t*er):n*rr},e.scale(179.976).clipAngle(147)};v.invert=function(n,t){if(!(n*n+4*t*t>Kt*Kt+Ut)){var r=n,e=t,o=25;do{var a,c=Qt(r),l=Qt(r/2),f=zt(r/2),s=Qt(e),g=zt(e),v=Qt(2*e),p=s*s,h=g*g,d=l*l,y=1-h*f*f,m=y?i(g*f)*u(a=1/y):a=0,w=2*m*g*l-n,E=m*s-t,M=a*(h*d+m*g*f*p),_=a*(.5*c*v-2*m*s*l),S=.25*a*(v*l-m*s*h*c),P=a*(p*f+m*d*g),x=_*S-P*M;if(!x)break;var b=(E*_-w*P)/x,j=(w*S-E*M)/x;r-=b,e-=j}while((Gt(b)>Ut||Gt(j)>Ut)&&--o>0);return[r,e]}};var ir=function(){return t.geoProjection(v).scale(152.63)},ur=function(){var n=20*er,r=n>=0?1:-1,e=Vt(r*n),o=t.geoProjectionMutator(p),i=o(n),u=i.stream;return i.parallel=function(t){return arguments.length?(e=Vt((r=(n=t*er)>=0?1:-1)*n),o(n)):n*rr},i.stream=function(t){var o=i.rotate(),a=u(t),c=(i.rotate([0,0]),u(t));return i.rotate(o),a.sphere=function(){c.polygonStart(),c.lineStart();for(var t=r*-180;r*t<180;t+=90*r)c.point(t,90*r);for(;r*(t-=n)>=-180;)c.point(t,r*-Lt(zt(t*er/2),e)*rr);c.lineEnd(),c.polygonEnd()},a},i.scale(218.695).center([0,28.0974])};h.invert=function(n,t){if(n*=3/8,t*=3/8,!n&&Gt(t)>1)return null;var r=n*n,e=t*t,i=1+r+e,a=u((i-u(i*i-4*t*t))/2),g=o(a)/3,v=a?s(Gt(t/a))/3:f(Gt(n))/3,p=zt(g),h=l(v),d=h*h-p*p;return[2*Ot(n)*Lt(c(v)*p,.25-d),2*Ot(t)*Lt(h*Qt(g),.25+d)]};var ar=function(){return t.geoProjection(h).scale(66.1603)},cr=u(8),lr=It(1+Jt);d.invert=function(n,t){if((e=Gt(t))<lr)return[n,2*qt(Ft(t))-Xt];var r,e,o=Zt,i=25;do{var u=zt(o/2),a=Vt(o/2);o-=r=(cr*(o-Zt)-It(a)-e)/(cr-u*u/(2*a))}while(Gt(r)>Yt&&--i>0);return[n/(zt(o)*(cr-1/Qt(o))),Ot(t)*o]};var fr=function(){return t.geoProjection(d).scale(112.314)},sr=function(){var n=5,r=t.geoProjectionMutator(y),e=r(n),i=e.stream,u=.01,a=-zt(u*er),c=Qt(u*er);return e.lobes=function(t){return arguments.length?r(n=+t):n},e.stream=function(t){var r=e.rotate(),l=i(t),f=(e.rotate([0,0]),i(t));return e.rotate(r),l.sphere=function(){f.polygonStart(),f.lineStart();for(var t=0,r=360/n,e=2*Kt/n,i=90-180/n,l=Xt;t<n;++t,i-=r,l-=e)f.point(Lt(c*zt(l),a)*rr,o(c*Qt(l))*rr),i<-90?(f.point(-90,-180-i-u),f.point(-90,-180-i+u)):(f.point(90,i+u),f.point(90,i-u));f.lineEnd(),f.polygonEnd()},l},e.scale(87.8076).center([0,17.1875]).clipAngle(179.999)},gr=w(Jt/Xt,Jt,Kt),vr=function(){return t.geoProjection(gr).scale(169.529)},pr=2.00276,hr=1.11072;E.invert=function(n,t){var r,e,o=pr*t,i=t<0?-Zt:Zt,u=25;do e=o-Jt*Qt(i),i-=r=(Qt(2*i)+2*i-Kt*Qt(e))/(2*zt(2*i)+2+Kt*zt(e)*Jt*zt(i));while(Gt(r)>Ut&&--u>0);return e=o-Jt*Qt(i),[n*(1/zt(e)+hr/zt(i))/pr,e]};var dr=function(){return t.geoProjection(E).scale(160.857)},yr=function(n){var r=0,e=t.geoProjectionMutator(n),o=e(r);return o.parallel=function(n){return arguments.length?e(r=n*er):r*rr},o};M.invert=function(n,t){return[n/zt(t),t]};var mr=function(){return t.geoProjection(M).scale(152.63)},wr=function(){return yr(_).scale(123.082).center([0,26.1441]).parallel(45)},Er=function(){var n=.5,r=t.geoProjectionMutator(S),e=r(n);return e.fraction=function(t){return arguments.length?r(n=+t):n},e.scale(158.837)},Mr=w(1,4/Kt,Kt),_r=function(){return t.geoProjection(Mr).scale(152.63)};N.invert=function(n,t){var r=(r=t/nr-1)*r;return[r>0?n*u(Kt/r)/2:0,o(1-r)]};var Sr=function(){return t.geoProjection(N).scale(95.6464).center([0,30])},Pr=function(){return yr(C).scale(249.828).clipAngle(90)},xr=u(3);G.invert=function(n,t){var r=3*o(t/(xr*nr));return[nr*n/(xr*(2*zt(2*r/3)-1)),r]};var br=function(){return t.geoProjection(G).scale(156.19)},jr=function(){return yr(q).parallel(38.58).scale(195.044)},Rr=function(){return yr(L).scale(124.75)};z.invert=function(n,t){var r=u(8/(3*Kt)),e=t/r;return[n/(r*(1-Gt(e)/Kt)),e]};var Ar=function(){return t.geoProjection(z).scale(165.664)};F.invert=function(n,t){var r=2-Gt(t)/u(2*Kt/3);return[n*u(6*Kt)/(2*r),Ot(t)*o((4-r*r)/3)]};var kr=function(){return t.geoProjection(F).scale(165.664)};T.invert=function(n,t){var r=u(Kt*(4+Kt))/2;return[n*r/(1+u(1-t*t*(4+Kt)/(4*Kt))),t*r/2]};var Nr=function(){return t.geoProjection(T).scale(180.739)};I.invert=function(n,t){var r=t*u((4+Kt)/Kt)/2,e=o(r),i=zt(e);return[n/(2/u(Kt*(4+Kt))*(1+i)),o((e+r*(i+2))/(2+Xt))]};var Cr=function(){return t.geoProjection(I).scale(180.739)};B.invert=function(n,t){var r=u(2+Kt),e=t*r/2;return[r*n/(1+zt(e)),e]};var Gr=function(){return t.geoProjection(B).scale(173.044)};H.invert=function(n,t){var r=1+Xt,e=u(r/2);return[2*n*e/(1+zt(t*=e)),o((t+Qt(t))/r)]};var qr=function(){return t.geoProjection(H).scale(173.044)},Lr=3+2*Jt;D.invert=function(n,t){if(!(r=h.invert(n/1.2,1.065*t)))return null;var r,e=r[0],o=r[1],i=20;n/=Lr,t/=Lr;do{var a=e/2,c=o/2,l=Qt(a),f=zt(a),s=Qt(c),g=zt(c),v=zt(o),p=u(v),d=s/(g+Jt*f*p),y=d*d,m=u(2/(1+y)),w=Jt*g+(f+l)*p,E=Jt*g+(f-l)*p,M=w/E,_=u(M),S=_-1/_,P=_+1/_,x=m*S-2*It(_)-n,b=m*d*P-2*qt(d)-t,j=s&&$t*p*l*y/s,R=(Jt*f*g+p)/(2*(g+Jt*f*p)*(g+Jt*f*p)*p),A=-.5*d*m*m*m,k=A*j,N=A*R,C=(C=2*g+Jt*p*(f-l))*C*_,G=(Jt*f*g*p+v)/C,q=-(Jt*l*s)/(p*C),L=S*k-2*G/_+m*(G+G/M),z=S*N-2*q/_+m*(q+q/M),F=d*P*k-2*j/(1+y)+m*P*j+m*d*(G-G/M),T=d*P*N-2*R/(1+y)+m*P*R+m*d*(q-q/M),I=z*F-T*L;if(!I)break;var B=(b*z-x*T)/I,H=(x*F-b*L)/I;e-=B,o=Bt(-Xt,Ht(Xt,o-H))}while((Gt(B)>Ut||Gt(H)>Ut)&&--i>0);return Gt(Gt(o)-Xt)<Ut?[0,o]:i&&[e,o]};var zr=function(){return t.geoProjection(D).scale(62.5271)},Fr=zt(35*er);W.invert=function(n,t){var r=t/(1+Fr);return[n&&n/(Fr*u(1-r*r)),2*qt(r)]};var Tr=function(){return t.geoProjection(W).scale(137.152)};O.invert=function(n,t){var r=qt(t/nr),e=zt(r),o=2*r;return[n*nr/2/(zt(o)*e*e),o]};var Ir=function(){return t.geoProjection(O).scale(135.264)},Br=function(n){function r(n){return i(Q(n))}function e(n){r[n]=function(t){return arguments.length?(i[n](t),r):i[n]()}}null==n&&(n=t.geoOrthographic);var i=n(),u=t.geoEquirectangular().scale(rr).precision(0).clipAngle(null).translate([0,0]);return i.invert&&(r.invert=function(n){return V(i.invert(n))}),r.stream=function(n){var t=i.stream(n),r=u.stream({point:function(n,r){t.point(n/2,o(Vt(-r/2*er))*rr)},lineStart:function(){t.lineStart()},lineEnd:function(){t.lineEnd()},polygonStart:function(){t.polygonStart()},polygonEnd:function(){t.polygonEnd()}});return r.sphere=t.sphere,r},r.rotate=function(n){return arguments.length?(u.rotate(n),r):u.rotate()},r.center=function(n){return arguments.length?(i.center(Q(n)),r):V(i.center())},e("clipAngle"),e("clipExtent"),e("scale"),e("translate"),e("precision"),r.scale(249.5)},Hr=function(){var n=6,r=30*er,e=zt(r),i=Qt(r),u=t.geoProjectionMutator(U),a=u(r,n),c=a.stream,l=.01,f=-zt(l*er),s=Qt(l*er);return a.radius=function(t){return arguments.length?(e=zt(r=t*er),i=Qt(r),u(r,n)):r*rr},a.lobes=function(t){return arguments.length?u(r,n=+t):n},a.stream=function(t){var r=a.rotate(),u=c(t),l=(a.rotate([0,0]),c(t));return a.rotate(r),u.sphere=function(){l.polygonStart(),l.lineStart();for(var t=0,r=2*Kt/n,u=0;t<n;++t,u-=r)l.point(Lt(s*zt(u),f)*rr,o(s*Qt(u))*rr),l.point(Lt(i*zt(u-r/2),e)*rr,o(i*Qt(u-r/2))*rr);l.lineEnd(),l.polygonEnd()},u},a.rotate([90,-40]).scale(91.7095).clipAngle(179.999)},Dr=function(n,t,r,e,i,a,c,l){function f(u,f){if(!f)return[n*u/Kt,0];var s=f*f,g=n+s*(t+s*(r+s*e)),v=f*(i-1+s*(a-l+s*c)),p=(g*g+v*v)/(2*v),h=u*o(g/p)/Kt;return[p*Qt(h),f*(1+s*l)+p*(1-zt(h))]}return arguments.length<8&&(l=0),f.invert=function(f,s){var g,v,p=Kt*f/n,h=s,d=50;do{var y=h*h,m=n+y*(t+y*(r+y*e)),w=h*(i-1+y*(a-l+y*c)),E=m*m+w*w,M=2*w,_=E/M,S=_*_,P=o(m/_)/Kt,x=p*P,b=m*m,j=(2*t+y*(4*r+6*y*e))*h,R=i+y*(3*a+5*y*c),A=2*(m*j+w*(R-1)),k=2*(R-1),N=(A*M-E*k)/(M*M),C=zt(x),G=Qt(x),q=_*C,L=_*G,z=p/Kt*(1/u(1-b/S))*(j*_-m*N)/S,F=L-f,T=h*(1+y*l)+_-q-s,I=N*G+q*z,B=q*P,H=1+N-(N*C-L*z),D=L*P,W=I*D-H*B;if(!W)break;p-=g=(T*I-F*H)/W,h-=v=(F*D-T*B)/W}while((Gt(g)>Ut||Gt(v)>Ut)&&--d>0);return[p,h]},f},Wr=Dr(2.8284,-1.6988,.75432,-.18071,1.76003,-.38914,.042555),Or=function(){return t.geoProjection(Wr).scale(149.995)},Qr=Dr(2.583819,-.835827,.170354,-.038094,1.543313,-.411435,.082742),Vr=function(){return t.geoProjection(Qr).scale(153.93)},Ur=Dr(5/6*Kt,-.62636,-.0344,0,1.3493,-.05524,0,.045),Yr=function(){return t.geoProjection(Ur).scale(130.945)};X.invert=function(n,t){var r,e=n,o=t,i=50;do{var u=o*o;o-=r=(o*(1+u/12)-t)/(1+u/4)}while(Gt(r)>Ut&&--i>0);i=50,n/=1-.162388*u;do{var a=(a=e*e)*a;e-=r=(e*(.87-952426e-9*a)-n)/(.87-.00476213*a)}while(Gt(r)>Ut&&--i>0);return[e,o]};var Kr=function(){return t.geoProjection(X).scale(131.747)},Xr=Dr(2.6516,-.76534,.19123,-.047094,1.36289,-.13965,.031762),Zr=function(){return t.geoProjection(Xr).scale(131.087)},$r=function(n){function t(t,e){var o=t>0?-.5:.5,i=n(t+o*Kt,e);return i[0]-=o*r,i}var r=n(Xt,0)[0]-n(-Xt,0)[0];return n.invert&&(t.invert=function(t,e){var o=t>0?-.5:.5,i=n.invert(t+o*r,e),u=i[0]-o*Kt;return u<-Kt?u+=2*Kt:u>Kt&&(u-=2*Kt),i[0]=u,i}),t};Z.invert=function(n,t){var r=Ot(n),e=Ot(t),i=-r*n,u=-e*t,a=u/i<1,c=J(a?u:i,a?i:u),l=c[0],f=c[1],s=zt(f);return a&&(l=-Xt-l),[r*(Lt(Qt(l)*s,-Qt(f))+Kt),e*o(zt(l)*s)]};var Jr=function(){return t.geoProjection($r(Z)).scale(239.75)};on.invert=function(n,t){var r=(Jt-1)/(Jt+1),e=u(1-r*r),o=en(Xt,e*e),i=-1,a=nn(.5*o-t,-n,e*e),c=an(a[0],a[1]),l=Lt(c[1],c[0])/i;return[l,2*qt(Ft(.5/i*It(r*c[0]*c[0]+r*c[1]*c[1])))-Xt]};var ne=function(){return t.geoProjection($r(on)).scale(151.496)};ln.invert=function(n,t){var r=2*o(t/2);return[n*zt(r/2)/zt(r),r]};var te=function(){var n=2,r=t.geoProjectionMutator(cn),e=r(n);return e.coefficient=function(t){return arguments.length?r(n=+t):n},e.scale(169.529)},re=function(){var n=0,r=t.geoProjectionMutator(fn),e=r(n),o=e.rotate,i=e.stream,u=t.geoCircle();return e.parallel=function(t){if(!arguments.length)return n*rr;var o=e.rotate();return r(n=t*er).rotate(o)},e.rotate=function(t){return arguments.length?(o.call(e,[t[0],t[1]-n*rr]),u.center([-t[0],-t[1]]),e):(t=o.call(e),t[1]+=n*rr,t)},e.stream=function(n){return n=i(n),n.sphere=function(){n.polygonStart();var t,r=.01,e=u.radius(90-r)().coordinates[0],o=e.length-1,i=-1;for(n.lineStart();++i<o;)n.point((t=e[i])[0],t[1]);for(n.lineEnd(),e=u.radius(90+r)().coordinates[0],o=e.length-1,n.lineStart();--i>=0;)n.point((t=e[i])[0],t[1]);n.lineEnd(),n.polygonEnd()},n},e.scale(79.4187).parallel(45).clipAngle(179.999)},ee=41+48/36+37/3600,oe=q(0),ie=function(){var n=4,r=t.geoProjectionMutator(gn),e=r(n),o=e.stream;return e.lobes=function(t){return arguments.length?r(n=+t):n},e.stream=function(r){var i=e.rotate(),u=o(r),a=(e.rotate([0,0]),o(r));return e.rotate(i),u.sphere=function(){t.geoStream(vn(180/n),a)},u},e.scale(239.75)},ue=function(){var n=1,r=t.geoProjectionMutator(pn),e=r(n);return e.ratio=function(t){return arguments.length?r(n=+t):n},e.scale(167.774).center([0,18.67])},ae=.7109889596207567,ce=.0528035274542;hn.invert=function(n,t){return t>-ae?gr.invert(n,t-ce):M.invert(n,t)};var le=function(){return t.geoProjection(hn).rotate([-20,-55]).scale(164.263).center([0,-5.4036])};dn.invert=function(n,t){return Gt(t)>ae?gr.invert(n,t+(t>0?ce:-ce)):M.invert(n,t)};var fe=function(){return t.geoProjection(dn).scale(152.63)},se=function(n,r){function e(t,e){for(var o=e<0?-1:1,i=r[+(e<0)],u=0,a=i.length-1;u<a&&t>i[u][2][0];++u);var c=n(t-i[u][1][0],e);return c[0]+=n(i[u][1][0],o*e>o*i[u][0][1]?i[u][0][1]:e)[0],c}var o=wn(r);r=r.map(function(n){return n.map(function(n){return[[n[0][0]*er,n[0][1]*er],[n[1][0]*er,n[1][1]*er],[n[2][0]*er,n[2][1]*er]]})});var i=r.map(function(t){return t.map(function(t){var r,e=n(t[0][0],t[0][1])[0],o=n(t[2][0],t[2][1])[0],i=n(t[1][0],t[0][1])[1],u=n(t[1][0],t[1][1])[1];return i>u&&(r=i,i=u,u=r),[[e,i],[o,u]]})}),u=t.geoProjection(e),a=u.stream;return n.invert&&(e.invert=function(t,o){for(var u=i[+(o<0)],a=r[+(o<0)],c=0,l=u.length;c<l;++c){var f=u[c];if(f[0][0]<=t&&t<f[1][0]&&f[0][1]<=o&&o<f[1][1]){var s=n.invert(t-n(a[c][1][0],0)[0],o);return s[0]+=a[c][1][0],yn(e(s[0],s[1]),[t,o])?s:null}}}),u.stream=function(n){var r=u.rotate(),e=a(n),i=(u.rotate([0,0]),a(n));return u.rotate(r),e.sphere=function(){t.geoStream(o,i)},e},u},ge=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]],ve=function(){return se(E,ge).scale(160.857)},pe=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]],he=function(){return se(dn,pe).scale(152.63)},de=[[[[-180,0],[-100,90],[-40,0]],[[-40,0],[30,90],[180,0]]],[[[-180,0],[-160,-90],[-100,0]],[[-100,0],[-60,-90],[-20,0]],[[-20,0],[20,-90],[80,0]],[[80,0],[140,-90],[180,0]]]],ye=function(){return se(gr,de).scale(169.529)},me=[[[[-180,0],[-90,90],[0,0]],[[0,0],[90,90],[180,0]]],[[[-180,0],[-90,-90],[0,0]],[[0,0],[90,-90],[180,0]]]],we=function(){return se(gr,me).scale(169.529).rotate([20,0])},Ee=[[[[-180,35],[-30,90],[0,35]],[[0,35],[30,90],[180,35]]],[[[-180,-10],[-102,-90],[-65,-10]],[[-65,-10],[5,-90],[77,-10]],[[77,-10],[103,-90],[180,-10]]]],Me=function(){return se(hn,Ee).rotate([-20,-55]).scale(164.263).center([0,-5.4036])},_e=[[[[-180,0],[-110,90],[-40,0]],[[-40,0],[0,90],[40,0]],[[40,0],[110,90],[180,0]]],[[[-180,0],[-110,-90],[-40,0]],[[-40,0],[0,-90],[40,0]],[[40,0],[110,-90],[180,0]]]],Se=function(){return se(M,_e).scale(152.63).rotate([-20,0])};En.invert=function(n,t){return[tr/3*n/u(Kt*Kt/3-t*t),t]};var Pe=function(){return t.geoProjection(En).scale(158.837)},xe=function(){var n=.5,r=t.geoProjectionMutator(Mn),e=r(n);return e.spacing=function(t){return arguments.length?r(n=+t):n},e.scale(124.75)},be=Kt/Jt;_n.invert=function(n,t){var r=Gt(n),e=Gt(t),o=Ut,a=Xt;e<be?a*=e/be:o+=6*i(be/e);for(var c=0;c<25;c++){var l=Qt(a),f=u(zt(a)),s=Qt(a/2),g=zt(a/2),v=Qt(o/6),p=zt(o/6),h=.5*o*(1+f)-r,d=a/(g*p)-e,y=f?-.25*o*l/f:0,m=.5*(1+f),w=(1+.5*a*s/g)/(g*p),E=a/g*(v/6)/(p*p),M=y*E-w*m,_=(h*E-d*m)/M,S=(d*y-h*w)/M;if(a-=_,o-=S,Gt(_)<Ut&&Gt(S)<Ut)break}return[n<0?-o:o,t<0?-a:a]};var je=function(){return t.geoProjection(_n).scale(97.2672)};Sn.invert=function(n,t){var r=Ot(n)*Kt,e=t/2,o=50;do{var i=r*r,u=e*e,a=r*e,c=r*(.975534+u*(-.119161+i*-.0143059+u*-.0547009))-n,l=e*(1.00384+i*(.0802894+u*-.02855+199025e-9*i)+u*(.0998909+u*-.0491032))-t,f=.975534-u*(.119161+3*i*.0143059+.0547009*u),s=-a*(.238322+.2188036*u+.0286118*i),g=a*(.1605788+7961e-7*i+-.0571*u),v=1.00384+i*(.0802894+199025e-9*i)+u*(3*(.0998909-.02855*i)-.245516*u),p=s*g-v*f,h=(l*s-c*v)/p,d=(c*g-l*f)/p;r-=h,e-=d}while((Gt(h)>Ut||Gt(d)>Ut)&&--o>0);return o&&[r,e]};var Re=function(){return t.geoProjection(Sn).scale(139.98)};Pn.invert=function(n,t){var r=n*n,e=t*t,a=e+1,c=n?$t*u((a-u(r*r+2*r*(e-1)+a*a))/r+1):1/u(a);return[o(n*c),Ot(t)*i(c)]};var Ae=function(){return t.geoProjection(Pn).scale(144.049).clipAngle(89.999)},ke=function(){return yr(xn).parallel(40).scale(158.837)};bn.invert=function(n,t){return[n,2.5*qt(Ft(.8*t))-.625*Kt]};var Ne=function(){return t.geoProjection(bn).scale(108.318)},Ce=[[.9972523,0],[.0052513,-.0041175],[.0074606,.0048125],[-.0153783,-.1968253],[.0636871,-.1408027],[.3660976,-.2937382]],Ge=[[.98879,0],[0,0],[-.050909,0],[0,0],[.075528,0]],qe=[[.984299,0],[.0211642,.0037608],[-.1036018,-.0575102],[-.0329095,-.0320119],[.0499471,.1223335],[.026046,.0899805],[7388e-7,-.1435792],[.0075848,-.1334108],[-.0216473,.0776645],[-.0225161,.0853673]],Le=[[.9245,0],[0,0],[.01943,0]],ze=[[.721316,0],[0,0],[-.00881625,-.00617325]],Fe=u(6),Te=u(7);qn.invert=function(n,t){var r=3*o(t*Te/9);return[n*Te/(Fe*(2*zt(2*r/3)-1)),o(3*Qt(r)*Fe/7)]};var Ie=function(){return t.geoProjection(qn).scale(164.859)};Ln.invert=function(n,t){var r=t*u(2+Jt)/(2*u(3)),e=2*o(r);return[3*Jt*n/(1+2*zt(e)/zt(e/2)),o((r+Qt(e))/(1+$t))]};var Be=function(){return t.geoProjection(Ln).scale(188.209)};zn.invert=function(n,t){var r=u(6/(4+Kt)),e=t/r;return Gt(Gt(e)-Xt)<Ut&&(e=e<0?-Xt:Xt),[1.5*n/(r*(.5+zt(e))),o((e/2+Qt(e))/(1+Kt/4))]};var He=function(){return t.geoProjection(zn).scale(166.518)};Fn.invert=function(n,t){var r,e=t,o=25;do{var i=e*e,u=i*i;e-=r=(e*(1.007226+i*(.015085+u*(-.044475+.028874*i-.005916*u)))-t)/(1.007226+i*(.045255+u*(-.311325+.259866*i-.005916*11*u)))}while(Gt(r)>Ut&&--o>0);return[n/(.8707+(i=e*e)*(-.131979+i*(-.013791+i*i*i*(.003971-.001529*i)))),e]};var De=function(){return t.geoProjection(Fn).scale(175.295)};Tn.invert=function(n,t){for(var r=t/2,e=0,o=1/0;e<10&&Gt(o)>Ut;++e){var i=zt(t/2);t-=o=(t-Vt(t/2)-r)/(1-.5/(i*i))}return[2*n/(1+zt(t)),t]};var We=function(){return t.geoProjection(Tn).scale(152.63)},Oe=1.0148,Qe=.23185,Ve=-.14499,Ue=.02406,Ye=Oe,Ke=5*Qe,Xe=7*Ve,Ze=9*Ue,$e=1.790857183;In.invert=function(n,t){t>$e?t=$e:t<-$e&&(t=-$e);var r,e=t;do{var o=e*e;e-=r=(e*(Oe+o*o*(Qe+o*(Ve+Ue*o)))-t)/(Ye+o*o*(Ke+o*(Xe+Ze*o)))}while(Gt(r)>Ut);return[n,e]};var Je=function(){return t.geoProjection(In).scale(139.319)};Bn.invert=function(n,t){if(Gt(t)<Ut)return[n,0];var r,e=n*n+t*t,u=.5*t,a=10;do{var c=Vt(u),l=1/zt(u),f=e-2*t*u+u*u;u-=r=(c*f+2*(u-t))/(2+f*l*l+2*(u-t)*c)}while(Gt(r)>Ut&&--a>0);return c=Vt(u),[(Gt(t)<Gt(u+1/c)?o(n*c):Ot(n)*(i(Gt(n*c))+Xt))/Qt(u),u]};var no=function(){return t.geoProjection(Bn).scale(103.74)},to=function(n,t){var r=Wn(n[1],n[0]),e=Wn(t[1],t[0]),o=Qn(r,e),i=On(r)/On(e);return Dn([1,0,n[0][0],0,1,n[0][1]],Dn([i,0,0,0,i,0],Dn([zt(o),Qt(o),0,-Qt(o),zt(o),0],[1,0,-t[0][0],0,1,-t[0][1]])))},ro=function(n,r,e){function o(n,t){if(n.edges=Kn(n.face),t)if(t.face){var r=n.shared=Yn(n.face,t.face),e=to(r.map(t.project),r.map(n.project));n.transform=t.transform?Dn(t.transform,e):e;for(var i=t.edges,u=0,a=i.length;u<a;++u)Un(r[0],i[u][1])&&Un(r[1],i[u][0])&&(i[u]=n),Un(r[0],i[u][0])&&Un(r[1],i[u][1])&&(i[u]=n);for(i=n.edges,u=0,a=i.length;u<a;++u)Un(r[0],i[u][0])&&Un(r[1],i[u][1])&&(i[u]=t),Un(r[0],i[u][1])&&Un(r[1],i[u][0])&&(i[u]=t)}else n.transform=t.transform;return n.children&&n.children.forEach(function(t){o(t,n)}),n}function i(n,t){var e,o=r(n,t),i=o.project([n*rr,t*rr]);return(e=o.transform)?[e[0]*i[0]+e[1]*i[1]+e[2],-(e[3]*i[0]+e[4]*i[1]+e[5])]:(i[1]=-i[1],i)}function u(n,t){var r=n.project.invert,e=n.transform,o=t;if(e&&(e=Hn(e),o=[e[0]*o[0]+e[1]*o[1]+e[2],e[3]*o[0]+e[4]*o[1]+e[5]]),r&&n===a(i=r(o)))return i;for(var i,c=n.children,l=0,f=c&&c.length;l<f;++l)if(i=u(c[l],t))return i}function a(n){return r(n[0]*er,n[1]*er)}e=null==e?-Kt/6:e,o(n,{transform:[zt(e),Qt(e),0,-Qt(e),zt(e),0]}),Xn(n)&&(i.invert=function(t,r){var e=u(n,[t,-r]);return e&&(e[0]*=er,e[1]*=er,e)});var c=t.geoProjection(i),l=c.stream;return c.stream=function(t){var r=c.rotate(),e=l(t),o=(c.rotate([0,0]),l(t));return c.rotate(r),e.sphere=function(){o.polygonStart(),o.lineStart(),Vn(o,n),o.lineEnd(),o.polygonEnd()},e},c},eo=[[0,90],[-90,0],[0,0],[90,0],[180,0],[0,-90]],oo=[[0,2,1],[0,3,2],[5,1,2],[5,2,3],[0,1,4],[0,4,3],[5,4,1],[5,3,4]].map(function(n){return n.map(function(n){return eo[n]})}),io=function(n){n=n||function(n){var r=t.geoCentroid({type:"MultiPoint",coordinates:n});return t.geoGnomonic().scale(1).translate([0,0]).rotate([-r[0],-r[1]])};var r=oo.map(function(t){return{face:t,project:n(t)}});return[-1,0,0,1,0,1,4,5].forEach(function(n,t){var e=r[n];e&&(e.children||(e.children=[])).push(r[t])}),ro(r[0],function(n,t){return r[n<-Kt/2?t<0?6:4:n<0?t<0?2:0:n<Kt/2?t<0?3:1:t<0?7:5]}).scale(101.858).center([0,45])},uo=2/u(3);Zn.invert=function(n,t){return N.invert(n/uo,t)};var ao=function(n){n=n||function(n){var r=t.geoCentroid({type:"MultiPoint",coordinates:n});return t.geoProjection(Zn).translate([0,0]).scale(1).rotate(r[1]>0?[-r[0],0]:[180-r[0],180])};var r=oo.map(function(t){return{face:t,project:n(t)}});return[-1,0,0,1,0,1,4,5].forEach(function(n,t){var e=r[n];e&&(e.children||(e.children=[])).push(r[t])}),ro(r[0],function(n,t){return r[n<-Kt/2?t<0?6:4:n<0?t<0?2:0:n<Kt/2?t<0?3:1:t<0?7:5]}).scale(121.906).center([0,48.5904])},co=function(n){function r(n,t){var r=zt(t),e=[r*zt(n),r*Qt(n),Qt(t)],i=n<-Kt/2?t<0?6:4:n<0?t<0?2:0:n<Kt/2?t<0?3:1:t<0?7:5,a=o[i];return u[$n(a[0],e)<0?8+3*i:$n(a[1],e)<0?8+3*i+1:$n(a[2],e)<0?8+3*i+2:i]}n=n||function(n){var r=6===n.length?t.geoCentroid({type:"MultiPoint",coordinates:n}):n[0];return t.geoGnomonic().scale(1).translate([0,0]).rotate([-r[0],-r[1]])};var e=oo.map(function(n){for(var t,r=n.map(tt),e=r.length,o=r[e-1],i=[],u=0;u<e;++u)t=r[u],i.push(nt([.9486832980505138*o[0]+.31622776601683794*t[0],.9486832980505138*o[1]+.31622776601683794*t[1],.9486832980505138*o[2]+.31622776601683794*t[2]]),nt([.9486832980505138*t[0]+.31622776601683794*o[0],.9486832980505138*t[1]+.31622776601683794*o[1],.9486832980505138*t[2]+.31622776601683794*o[2]])),o=t;return i}),o=[],i=[-1,0,0,1,0,1,4,5];e.forEach(function(n,t){for(var r=oo[t],u=r.length,a=o[t]=[],c=0;c<u;++c)e.push([r[c],n[(2*c+2)%(2*u)],n[(2*c+1)%(2*u)]]),i.push(t),a.push(Jn(tt(n[(2*c+2)%(2*u)]),tt(n[(2*c+1)%(2*u)])))});var u=e.map(function(t){return{project:n(t),face:t}});return i.forEach(function(n,t){var r=u[n];r&&(r.children||(r.children=[])).push(u[t])}),ro(u[0],r).scale(110.625).center([0,45])},lo=function(){},fo=function(n){if((t=n.length)<4)return!1;for(var t,r=0,e=n[t-1][1]*n[0][0]-n[t-1][0]*n[0][1];++r<t;)e+=n[r-1][1]*n[r][0]-n[r-1][0]*n[r][1];return e<=0},so=function(n,t){for(var r=t[0],e=t[1],o=!1,i=0,u=n.length,a=u-1;i<u;a=i++){var c=n[i],l=c[0],f=c[1],s=n[a],g=s[0],v=s[1];f>e^v>e&&r<(g-l)*(e-f)/(v-f)+l&&(o=!o)}return o},go=function(n,t){var r,e=t.stream;if(!e)throw new Error("invalid projection");switch(n&&n.type){case"Feature":r=et;break;case"FeatureCollection":r=rt;break;default:r=it}return r(n,e)},vo=[],po=[],ho={point:function(n,t){vo.push([n,t])},result:function(){var n=vo.length?vo.length<2?{type:"Point",coordinates:vo[0]}:{type:"MultiPoint",coordinates:vo}:null;return vo=[],n}},yo={lineStart:lo,point:function(n,t){vo.push([n,t])},lineEnd:function(){vo.length&&(po.push(vo),vo=[])},result:function(){var n=po.length?po.length<2?{type:"LineString",coordinates:po[0]}:{type:"MultiLineString",coordinates:po}:null;return po=[],n}},mo={polygonStart:lo,lineStart:lo,point:function(n,t){vo.push([n,t])},lineEnd:function(){var n=vo.length;if(n){do vo.push(vo[0].slice());while(++n<4);po.push(vo),vo=[]}},polygonEnd:lo,result:function(){if(!po.length)return null;var n=[],t=[];return po.forEach(function(r){fo(r)?n.push([r]):t.push(r)}),t.forEach(function(t){var r=t[0];n.some(function(n){if(so(n[0],r))return n.push(t),!0})||n.push([t])}),po=[],n.length?n.length>1?{type:"MultiPolygon",coordinates:n}:{type:"Polygon",coordinates:n[0]}:null}},wo=function(n){function r(t,r){var o=Gt(t)<Xt,i=n(o?t:t>0?t-Kt:t+Kt,r),u=(i[0]-i[1])*$t,a=(i[0]+i[1])*$t;if(o)return[u,a];var c=e*$t,l=u>0^a>0?-1:1;return[l*u-Ot(a)*c,l*a-Ot(u)*c]}var e=n(Xt,0)[0]-n(-Xt,0)[0];return n.invert&&(r.invert=function(t,r){var o=(t+r)*$t,i=(r-t)*$t,u=Gt(o)<.5*e&&Gt(i)<.5*e;if(!u){var a=e*$t,c=o>0^i>0?-1:1,l=-c*(t+(i>0?1:-1)*a),f=-c*(r+(o>0?1:-1)*a);o=(-l-f)*$t,i=(l-f)*$t}var s=n.invert(o,i);return u||(s[0]+=o>0?Kt:-Kt),s}),t.geoProjection(r).rotate([-90,-90,45]).clipAngle(179.999)},Eo=function(){return wo(Z).scale(176.423)},Mo=function(){return wo(on).scale(111.48)},_o=function(n,t){function r(n){n[0]=+n[0].toFixed(t),n[1]=+n[1].toFixed(t)}function e(n){n.forEach(r)}function o(n){n.forEach(e)}function i(n){if(n)switch(n.type){case"GeometryCollection":n.geometries.forEach(i);break;case"Point":r(n.coordinates);break;case"MultiPoint":case"LineString":e(n.coordinates);break;case"MultiLineString":case"Polygon":o(n.coordinates);break;case"MultiPolygon":n.coordinates.forEach(o);break;default:return}}function u(n){i(n.geometry)}if(!(0<=(t=+t)&&t<=20))throw new Error("invalid digits");if(n)switch(n.type){case"Feature":u(n);break;case"FeatureCollection":n.features.forEach(u);break;default:i(n)}return n},So=function(){return yr(ut).scale(131.215)},Po=[[.9986,-.062],[1,0],[.9986,.062],[.9954,.124],[.99,.186],[.9822,.248],[.973,.31],[.96,.372],[.9427,.434],[.9216,.4958],[.8962,.5571],[.8679,.6176],[.835,.6769],[.7986,.7346],[.7597,.7903],[.7186,.8435],[.6732,.8936],[.6213,.9394],[.5722,.9761],[.5322,1]];Po.forEach(function(n){n[1]*=1.0144}),at.invert=function(n,t){var r=t/Xt,e=90*r,o=Ht(18,Gt(e/5)),i=Bt(0,Tt(o));do{var u=Po[i][1],a=Po[i+1][1],c=Po[Ht(19,i+2)][1],l=c-u,f=c-2*a+u,s=2*(Gt(r)-a)/l,g=f/l,v=s*(1-g*s*(1-2*g*s));if(v>=0||1===i){e=(t>=0?5:-5)*(v+o);var p,h=50;do o=Ht(18,Gt(e)/5),i=Tt(o),v=o-i,u=Po[i][1],a=Po[i+1][1],c=Po[Ht(19,i+2)][1],e-=(p=(t>=0?Xt:-Xt)*(a+v*(c-u)/2+v*v*(c-2*a+u)/2)-t)*rr;while(Gt(p)>Yt&&--h>0);break}}while(--i>=0);var d=Po[i][0],y=Po[i+1][0],m=Po[Ht(19,i+2)][0];return[n/(y+v*(m-d)/2+v*v*(m-2*y+d)/2),e*er]};var xo=function(){return t.geoProjection(at).scale(152.63)},bo=function(){var n=2,r=0,e=t.geoProjectionMutator(lt),o=e(n,r);return o.distance=function(t){return arguments.length?e(n=+t,r):n},o.tilt=function(t){return arguments.length?e(n,r=t*er):r*rr},o.scale(432.147).clipAngle(i(1/n)*rr-1e-6)},jo=1e-4,Ro=1e4,Ao=-180,ko=Ao+jo,No=180,Co=No-jo,Go=-90,qo=Go+jo,Lo=90,zo=Lo-jo,Fo=function(n){if(n)switch(n.type){case"Feature":dt(n);break;case"FeatureCollection":n.features.forEach(dt);break;default:yt(n)}return n};mt.invert=function(n,t){var r=t/1.70711,e=Qt(Zt*r);return[n/(.74482-.34588*e*e),2*qt(r)]};var To=function(){return t.geoProjection(mt).scale(146.153)},Io=function(n,r,e){var i=t.geoInterpolate(r,e),u=i(.5),a=t.geoRotation([-u[0],-u[1]])(r),c=i.distance/2,l=-o(Qt(a[1]*er)/Qt(c)),f=[-u[0],-u[1],-(a[0]>0?Kt-l:l)*rr],s=t.geoProjection(n(c)).rotate(f),g=t.geoRotation(f),v=s.center;return delete s.rotate,s.center=function(n){return arguments.length?v(g(n)):g.invert(v())},s.clipAngle(90)};xt.invert=function(n,t){if(Gt(t)<Ut)return[n,0];if(Gt(n)<Ut)return[0,Xt*Qt(2*qt(t/Kt))];var r=(n/=Kt)*n,e=(t/=Kt)*t,o=r+e,a=o*o,c=-Gt(t)*(1+o),l=c-2*e+r,f=-2*c+1+2*e+a,s=e/f+(2*l*l*l/(f*f*f)-9*c*l/(f*f))/27,g=(c-l*l/(3*f))/f,v=2*u(-g/3),p=i(3*s/(g*v))/3;return[Kt*(o-1+u(1+2*(r-e)+a))/(2*n),Ot(t)*Kt*(-v*zt(p+Kt/3)-l/(3*f))]};var Bo=function(){return t.geoProjection(xt).scale(79.4183);
};bt.invert=function(n,t){if(!n)return[0,Xt*Qt(2*qt(t/Kt))];var r=Gt(n/Kt),e=(1-r*r-(t/=Kt)*t)/(2*r),o=e*e,i=u(o+1);return[Ot(n)*Kt*(i-e),Ot(t)*Xt*Qt(2*Lt(u((1-2*e*r)*(e+i)-r),u(i+e+r)))]};var Ho=function(){return t.geoProjection(bt).scale(79.4183)};jt.invert=function(n,t){if(!t)return[n,0];var r=t/Kt,e=(Kt*Kt*(1-r*r)-n*n)/(2*Kt*n);return[n?Kt*(Ot(n)*u(e*e+1)-e):0,Xt*Qt(2*qt(r))]};var Do=function(){return t.geoProjection(jt).scale(79.4183)};Rt.invert=function(n,t){var r;if(!n||!t)return[n,t];t/=Kt;var e=Ot(n)*n/Xt,o=(e*e-1+4*t*t)/Gt(e),i=o*o,a=2*t,c=50;do{var l=a*a,f=(8*a-l*(l+2)-5)/(2*l*(a-1)),s=(3*a-l*a-10)/(2*l*a),g=f*f,v=a*f,p=a+f,h=p*p,d=a+3*f,y=h*(l+g*i-1)+(1-l)*(l*(d*d+4*g)+g*(12*v+4*g)),m=-2*p*(4*v*g+(1-4*l+3*l*l)*(1+s)+g*(-6+14*l-i+(-8+8*l-2*i)*s)+v*(-8+12*l+(-10+10*l-i)*s)),w=u(y),E=o*(h+g-1)+2*w-e*(4*h+i),M=o*(2*f*s+2*p*(1+s))+m/w-8*p*(o*(-1+g+h)+2*w)*(1+s)/(i+4*h);a-=r=E/M}while(r>Ut&&--c>0);return[Ot(n)*(u(o*o+4)+o)*Kt/4,Xt*a]};var Wo=function(){return t.geoProjection(Rt).scale(127.16)},Oo=4*Kt+3*u(3),Qo=2*u(2*Kt*u(3)/Oo),Vo=w(Qo*u(3)/Kt,Qo,Oo/6),Uo=function(){return t.geoProjection(Vo).scale(176.84)};At.invert=function(n,t){return[n/u(1-3*t*t/(Kt*Kt)),t]};var Yo=function(){return t.geoProjection(At).scale(152.63)};kt.invert=function(n,t){var r=n/2.66723,e=t/1.24104,i=u(r*r+e*e),a=2*o(i/2);return[3*Lt(n*Vt(a),2.66723*i),i&&o(t*Qt(a)/(1.24104*.90631*i))]};var Ko=function(){return t.geoProjection(kt).scale(172.632)};Nt.invert=function(n,t){var r=(n*n+t*t)/-2,e=u(-r*(2+r)),i=t*r+n*e,a=n*r-t*e,c=u(a*a+i*i);return[Lt(e*i,c*(1+r)),c?-o(e*a/c):0]};var Xo=function(){return t.geoProjection(Nt).rotate([0,-90,45]).scale(124.75).clipAngle(179.999)};Ct.invert=function(n,t){var r=n,e=t,o=25;do{var a,c=zt(e),l=Qt(e),f=Qt(2*e),s=l*l,g=c*c,v=Qt(r),p=zt(r/2),h=Qt(r/2),d=h*h,y=1-g*p*p,m=y?i(c*p)*u(a=1/y):a=0,w=.5*(2*m*c*h+r/Xt)-n,E=.5*(m*l+e)-t,M=.5*a*(g*d+m*c*p*s)+.5/Xt,_=a*(v*f/4-m*l*h),S=.125*a*(f*h-m*l*g*v),P=.5*a*(s*p+m*d*c)+.5,x=_*S-P*M,b=(E*_-w*P)/x,j=(w*S-E*M)/x;r-=b,e-=j}while((Gt(b)>Ut||Gt(j)>Ut)&&--o>0);return[r,e]};var Zo=function(){return t.geoProjection(Ct).scale(158.837)};n.geoAiry=or,n.geoAiryRaw=g,n.geoAitoff=ir,n.geoAitoffRaw=v,n.geoArmadillo=ur,n.geoArmadilloRaw=p,n.geoAugust=ar,n.geoAugustRaw=h,n.geoBaker=fr,n.geoBakerRaw=d,n.geoBerghaus=sr,n.geoBerghausRaw=y,n.geoBoggs=dr,n.geoBoggsRaw=E,n.geoBonne=wr,n.geoBonneRaw=_,n.geoBottomley=Er,n.geoBottomleyRaw=S,n.geoBromley=_r,n.geoBromleyRaw=Mr,n.geoChamberlin=k,n.geoChamberlinRaw=j,n.geoChamberlinAfrica=A,n.geoCollignon=Sr,n.geoCollignonRaw=N,n.geoCraig=Pr,n.geoCraigRaw=C,n.geoCraster=br,n.geoCrasterRaw=G,n.geoCylindricalEqualArea=jr,n.geoCylindricalEqualAreaRaw=q,n.geoCylindricalStereographic=Rr,n.geoCylindricalStereographicRaw=L,n.geoEckert1=Ar,n.geoEckert1Raw=z,n.geoEckert2=kr,n.geoEckert2Raw=F,n.geoEckert3=Nr,n.geoEckert3Raw=T,n.geoEckert4=Cr,n.geoEckert4Raw=I,n.geoEckert5=Gr,n.geoEckert5Raw=B,n.geoEckert6=qr,n.geoEckert6Raw=H,n.geoEisenlohr=zr,n.geoEisenlohrRaw=D,n.geoFahey=Tr,n.geoFaheyRaw=W,n.geoFoucaut=Ir,n.geoFoucautRaw=O,n.geoGilbert=Br,n.geoGingery=Hr,n.geoGingeryRaw=U,n.geoGinzburg4=Or,n.geoGinzburg4Raw=Wr,n.geoGinzburg5=Vr,n.geoGinzburg5Raw=Qr,n.geoGinzburg6=Yr,n.geoGinzburg6Raw=Ur,n.geoGinzburg8=Kr,n.geoGinzburg8Raw=X,n.geoGinzburg9=Zr,n.geoGinzburg9Raw=Xr,n.geoGringorten=Jr,n.geoGringortenRaw=Z,n.geoGuyou=ne,n.geoGuyouRaw=on,n.geoHammer=te,n.geoHammerRaw=cn,n.geoHammerRetroazimuthal=re,n.geoHammerRetroazimuthalRaw=fn,n.geoHealpix=ie,n.geoHealpixRaw=gn,n.geoHill=ue,n.geoHillRaw=pn,n.geoHomolosine=fe,n.geoHomolosineRaw=dn,n.geoInterrupt=se,n.geoInterruptedBoggs=ve,n.geoInterruptedHomolosine=he,n.geoInterruptedMollweide=ye,n.geoInterruptedMollweideHemispheres=we,n.geoInterruptedSinuMollweide=Me,n.geoInterruptedSinusoidal=Se,n.geoKavrayskiy7=Pe,n.geoKavrayskiy7Raw=En,n.geoLagrange=xe,n.geoLagrangeRaw=Mn,n.geoLarrivee=je,n.geoLarriveeRaw=_n,n.geoLaskowski=Re,n.geoLaskowskiRaw=Sn,n.geoLittrow=Ae,n.geoLittrowRaw=Pn,n.geoLoximuthal=ke,n.geoLoximuthalRaw=xn,n.geoMiller=Ne,n.geoMillerRaw=bn,n.geoModifiedStereographic=Gn,n.geoModifiedStereographicRaw=jn,n.geoModifiedStereographicAlaska=Rn,n.geoModifiedStereographicGs48=An,n.geoModifiedStereographicGs50=kn,n.geoModifiedStereographicMiller=Nn,n.geoModifiedStereographicLee=Cn,n.geoMollweide=vr,n.geoMollweideRaw=gr,n.geoMtFlatPolarParabolic=Ie,n.geoMtFlatPolarParabolicRaw=qn,n.geoMtFlatPolarQuartic=Be,n.geoMtFlatPolarQuarticRaw=Ln,n.geoMtFlatPolarSinusoidal=He,n.geoMtFlatPolarSinusoidalRaw=zn,n.geoNaturalEarth=De,n.geoNaturalEarthRaw=Fn,n.geoNellHammer=We,n.geoNellHammerRaw=Tn,n.geoPatterson=Je,n.geoPattersonRaw=In,n.geoPolyconic=no,n.geoPolyconicRaw=Bn,n.geoPolyhedral=ro,n.geoPolyhedralButterfly=io,n.geoPolyhedralCollignon=ao,n.geoPolyhedralWaterman=co,n.geoProject=go,n.geoGringortenQuincuncial=Eo,n.geoPeirceQuincuncial=Mo,n.geoPierceQuincuncial=Mo,n.geoQuantize=_o,n.geoQuincuncial=wo,n.geoRectangularPolyconic=So,n.geoRectangularPolyconicRaw=ut,n.geoRobinson=xo,n.geoRobinsonRaw=at,n.geoSatellite=bo,n.geoSatelliteRaw=lt,n.geoSinuMollweide=le,n.geoSinuMollweideRaw=hn,n.geoSinusoidal=mr,n.geoSinusoidalRaw=M,n.geoStitch=Fo,n.geoTimes=To,n.geoTimesRaw=mt,n.geoTwoPointAzimuthal=Mt,n.geoTwoPointAzimuthalRaw=wt,n.geoTwoPointAzimuthalUsa=Et,n.geoTwoPointEquidistant=Pt,n.geoTwoPointEquidistantRaw=_t,n.geoTwoPointEquidistantUsa=St,n.geoVanDerGrinten=Bo,n.geoVanDerGrintenRaw=xt,n.geoVanDerGrinten2=Ho,n.geoVanDerGrinten2Raw=bt,n.geoVanDerGrinten3=Do,n.geoVanDerGrinten3Raw=jt,n.geoVanDerGrinten4=Wo,n.geoVanDerGrinten4Raw=Rt,n.geoWagner4=Uo,n.geoWagner4Raw=Vo,n.geoWagner6=Yo,n.geoWagner6Raw=At,n.geoWagner7=Ko,n.geoWagner7Raw=kt,n.geoWiechel=Xo,n.geoWiechelRaw=Nt,n.geoWinkel3=Zo,n.geoWinkel3Raw=Ct,Object.defineProperty(n,"__esModule",{value:!0})}),define("d3_map",["jquery","d3","topojson","static_urls","d3-array","d3-geo","d3-geo-projection"],function(n,t,r,e){function o(){function o(n){f=l.selectAll("circle").data(n),f.enter().append("circle").attr("cx",function(n){return c(n)[0]}).attr("cy",function(n){return c(n)[1]}).attr("r",0).transition().duration(500).attr("r","3").attr("fill",function(n){return"#239023"}).attr("stroke","#196719").attr("opacity","0.8")}function i(n){var t=n.coordinates;f=l.selectAll("circle");var r=f.size();0==r?o(t):(f=l.selectAll("circle").data([]),f.exit().transition().duration(500).remove().on("end",function(){r-=1,0==r&&o(t)}).attr("r","0"))}var u=n("#map_widget").height(),a=n("#map_widget").width(),c=t.geoMercator(),l=t.select("#map_widget").append("svg").attr("width",a).attr("height",u),f=l.selectAll("circle");t.json(e.nc_adm_topojson,function(e,o){if(e)throw e;var i=r.feature(o,o.objects.nc_adm0),f=t.geoCentroid(i),s=150,g=[a/2+10,u/2-10];c=t.geoMercator().scale(s).center(f).translate(g);var v=t.geoPath().projection(c),p=v.bounds(i),h=s*a/(p[1][0]-p[0][0]),d=s*u/(p[1][1]-p[0][1]),s=h<d?h:d,g=[a-(p[0][0]+p[1][0])/2,u-(p[0][1]+p[1][1])/2];c=t.geoMercator().center(f).scale(.9*s).translate(g),v=v.projection(c),l.append("path").datum(i).attr("class","land").attr("d",v),n("#preloader").trigger("hide")}),n("#taxon_treeview").on("taxonSelected",function(n,t){i(t)})}return{initMap:o}}),define("d3_elevation_rainfall_scatterplot",["jquery","d3","d3-array"],function(n,t){function r(){function r(n,r){var o=n.environmental_values.elevation,i=n.environmental_values.rainfall,u=n.environmental_values.tax_full_name,a=[[]];o&&(a=o.map(function(n,t){return[E(n),M(i[t])]}));var c=a.map(function(n){return n[0]}).sort(function(n,t){return n-t}),l=t.quantile(c,.75)-t.quantile(c,.25),f=1.06*Math.min(t.deviation(c),l/1.34)*Math.pow(a.length,-.2),s=f*f;y=p.map(function(n){return e(n,a,f,s)}),h.domain([0,t.max(y)||0]),p.forEach(function(n,t){w.beginPath(),w.fillStyle=d(h(y[t])),w.rect(n[0]-v/2,n[1]-v/2,v,v),w.fill(),w.closePath()});var g=S.selectAll("circle").data(o||[]);g.enter().append("circle").attr("class","dot").attr("fill",function(n,t){return r[u[t]]||r.Autres}).attr("cx",function(n){return E(n)}).attr("cy",function(n,t){return M(i[t])}).transition().duration(1e3).attr("r",4),g.transition().duration(1e3).attr("fill",function(n,t){return r[u[t]]||r.Autres}).attr("cx",function(n){return E(n)}).attr("cy",function(n,t){return M(i[t])}),g.exit().transition().duration(1e3).attr("r",0).remove()}var o=0,i=1628,u=290,a=4820,c=n("#elevation_rainfall_scatterplot").height(),l=n("#elevation_rainfall_scatterplot").width(),f={top:.05*c,right:.07*l,bottom:.13*c,left:.1*l},s=c-f.top-f.bottom,g=l-f.left-f.right,v=10,p=t.merge(t.range(0,s/v).map(function(n){return t.range(0,g/v).map(function(t){return[t*v+v/2,n*v+v/2]})})),h=t.scalePow().exponent(.6).domain([0,1]).range([0,1]),d=t.scaleLinear().clamp(!0).domain([0,.1111111111111111,.2222222222222222,.3333333333333333,.4444444444444444,.5555555555555555,.6666666666666666,.7777777777777777,.8888888888888888,1]).range(["#ffffff","#e6edeb","#e1dac7","#e9c693","#f7b04b","#ff8f00","#f46400","#db3b00","#b81602","#8b0000"]),y=[],m=t.select("#elevation_rainfall_scatterplot").append("canvas").attr("width",g).attr("height",s).style("position","absolute").style("left",f.left+"px").style("top",f.top+41+"px").style("opacity",.75),w=m.node().getContext("2d"),E=t.scaleLinear().domain([o,i]).range([0,g]),M=t.scaleLinear().domain([u,a]).range([s,0]),_=t.select("#elevation_rainfall_scatterplot").append("svg").attr("width",l).attr("height",c),S=_.append("g").attr("transform","translate("+f.left+","+f.top+")"),P=_.append("g").attr("transform","translate("+f.left+","+(s+f.top)+")");P.call(t.axisBottom(E));var x=_.append("g").attr("transform","translate("+f.left+","+f.top+")");x.call(t.axisLeft(M)),_.append("text").attr("transform","translate("+l/2+" ,"+(c-15)+")").style("text-anchor","middle").text("Altitude (m)"),_.append("text").attr("transform","rotate(-90)").attr("y",f.left-63).attr("x",0-c/2).attr("dy","1em").style("text-anchor","middle").text("Prcipitations (mm/an)"),n("#taxon_treeview").on("taxonSelected",function(n,t,e,o,i){r(t,i)})}function e(n,r,e,u){return t.mean(r,function(t){return i(o(t,n)/e)})/u}function o(n,t){return Math.sqrt((n[0]-t[0])*(n[0]-t[0])+(n[1]-t[1])*(n[1]-t[1]))}function i(n){return Math.exp(-n*n/2)/2.5066}return{initElevationRainfallScatterplot:r}}),requirejs.config({baseUrl:"/static/taxon_dashboards/js"}),require(["jquery","taxonomy","d3","topojson","static_urls","d3_distribution_donut","d3_map","d3_elevation_rainfall_scatterplot","jquery.treeview"],function(n,t,r,e,o,i,u,a){function c(n){var t=n.taxon_distribution;if(M=n.nb_occurrences,t.sort(function(n,t){return n[1]<t[1]?-1:n[1]>t[1]?1:0}),t.reverse(),t.length>10){for(var r=["Autres",0,[]],e=9;e<t.length;e++){var o=t[e];r[1]+=o[1],r[2].push(o[0])}t=t.slice(0,9),t.push(r)}for(var i={},e=0;e<t.length;e++)i[t[e][0]]=w[e];_=i,E=t}function l(t){n("#selected_taxon_name").html(t.text)}function f(t){m=0,p();var e="/api/1.0/dashboard/taxon_dashboard/"+t+"/?include_coordinates=true&include_taxon_distribution=true&include_environmental_values=true";r.json(e,function(t,r){if(t)throw t;c(r),n("#taxon_treeview").trigger("taxonSelected",[r,E,M,_]),h(!1),h(!1)})}function s(){n("#input-search").val(""),n("#input-search").change(function(){n("#taxon_treeview").treeview("collapseAll");var t=n("#input-search").val(),r=n("#taxon_treeview").treeview("search",t,{ignoreCase:!0,exactMatch:!1,revealResults:!0});if(0!=r.length){var e=n("[data-nodeid='"+r[0].nodeId+"']"),o=n("#taxon_treeview").offset().top,i=n("#taxon_treeview").scrollTop(),u=e.offset().top-o+i;n("#taxon_treeview").animate({scrollTop:u},200)}})}function g(){function t(t){var r=n("#taxon_treeview").treeview("getSelected")[0];n("#tax_rank_value").text(e[r.rank]),n("#tax_occ_nb_value").text(t.nb_occurrences);t.total_nb_occurrences}var e={FAMILY:"Famille",GENUS:"Genre",SPECIE:"Espce",INFRA:"Infra"},o=n("#tax_proportion_total").height(),i=n("#tax_proportion_total").width();r.format(".3%"),r.select("#tax_proportion_total").append("svg").attr("width",i).attr("height",o);n("#taxon_treeview").on("taxonSelected",function(n,r){t(r)})}function v(){n("#modal").on("shown.bs.modal",function(){n(document).off("focusin.modal")}),n("#modal").modal({backdrop:"static",keyboard:!1}),n(".modal-backdrop").appendTo("#right_panel"),n("#taxon_treeview").on("taxonSelected",function(t,r){n("#modal").modal("hide")})}function p(){document.getElementById("preloader").style.display="inline"}function h(n){m+=1,m>=2&&(document.getElementById("preloader").style.display="none",n&&v())}function d(n){n.text=n.full_name,n.icon="glyphicon",n.state={expanded:!1}}function y(n){n.icon="glyphicon glyphicon-leaf"}var m=0,w=["#5496c4","#ffd24d","#a29cc9","#f96353","#6cc6b7","#fcac4f","#a0d643","#f99fcd","#b068b1","#b3b3b3"],E=[],M=0,_={};n("#preloader").on("hide",function(){h(!0)}),t.getTaxaTree(function(t){n("#taxon_treeview").treeview({data:t,onNodeSelected:function(n,t){l(t),f(t.id)}}),h(!0)},{make_node:d,make_leaf:y}),s(),g(),u.initMap(),i.initDonutChart(),a.initElevationRainfallScatterplot()}),define("main",function(){});